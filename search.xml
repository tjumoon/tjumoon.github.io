<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[ã€è¯‘ã€‘GoåŒ…é£Žæ ¼æŒ‡å—]]></title>
    <url>%2F2018%2F05%2F04%2FStyle-guideline-for-Go-packages%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç¿»è¯‘è‡³Style guideline for Go packages GOä¸Žè¯­è¨€ä¸­çš„æ‰€æœ‰å…¶ä»–äº‹ç‰©ä¸€æ ·å‘½åå’Œç»„ç»‡ã€‚ç»“æž„è‰¯å¥½çš„Goä»£ç å¯ä»¥å¾ˆå®¹æ˜“è¢«å‘çŽ°ï¼Œä½¿ç”¨å’Œé˜…è¯»ã€‚ä¸€ä¸ªç»“æž„è‰¯å¥½çš„ä»£ç å¦‚åŒä¸Žä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„APIæŽ¥å£ä¸€æ ·é‡è¦ã€‚ä½ç½®ã€å‘½åã€ä»¥åŠåŒ…ç»“æž„æ˜¯ä½ çš„ç”¨æˆ·é¦–å…ˆçœ‹åˆ°å¹¶ä¸Žå…¶æ‰“äº¤é“çš„ã€‚ æœ¬æ–‡çš„ç›®æ ‡æ˜¯ç”¨ä¸€äº›æœ€ä½³å®žè·µæ¥æŒ‡å¯¼ä½ è€Œä¸æ˜¯è®¾ç½®è§„åˆ™ã€‚è¯»è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„åˆ¤æ–­æ¥é€‰æ‹©æœ€ä¼˜é›…çš„æ–¹æ¡ˆæ¥åº”å¯¹ç‰¹æ®Šçš„åœºæ™¯ã€‚ åŒ…æ‰€æœ‰Goä»£ç éƒ½æ˜¯ä»¥åŒ…çš„å½¢å¼ç»„ç»‡åœ¨ä¸€èµ·çš„ã€‚Goè¯­è¨€ä¸­çš„åŒ…å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç›®å½•/æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª.goæ–‡ä»¶ã€‚Goè¯­è¨€ä½¿ç”¨åŒ…æ¥ç®¡ç†ã€ç»„ç»‡ä»£ç ï¼Œå°±å¦‚åŒè®¡ç®—æœºé€šè¿‡ç›®å½•/æ–‡ä»¶å¤¹æ¥ç»„ç»‡æ–‡ä»¶ä¸€æ ·ã€‚ æ‰€æœ‰çš„Goä»£ç éƒ½æ˜¯æ”¾åœ¨åŒ…é‡Œçš„ï¼ŒGoè¯­è¨€çš„åŒ…æ˜¯è®¿é—®Goä»£ç çš„å…¥å£ã€‚ç†è§£å’Œå»ºç«‹è‰¯å¥½çš„åŒ…ç»„ç»‡å®žè·µå¯¹äºŽå†™å‡ºé«˜æ•ˆçš„Goä»£ç æ˜¯éžå¸¸é‡è¦çš„ åŒ…ç»„ç»‡è®©æˆ‘ä»¬ä»Žå¦‚ä½•ç»„ç»‡Goä»£ç ä»¥åŠè§£é‡Šå¦‚ä½•è®¾ç½®GoåŒ…å¼€å§‹ã€‚ ä½¿ç”¨å¤šæ–‡ä»¶ä¸€ä¸ªåŒ…å°±æ˜¯ä¸€ä¸ªé‡Œé¢åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªGoæ–‡ä»¶çš„ç›®å½•ã€‚å°½æƒ…å°†ä½ çš„ä»£ç æŒ‰ç…§é€»è¾‘åˆ’åˆ†åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ä»¥èŽ·å¾—æœ€ä½³çš„å¯è¯»æ€§ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªHTTPåŒ…å¯ä»¥æ ¹æ®HTTPåŠŸèƒ½æ–¹é¢åˆ’åˆ†åˆ°ä¸åŒæ–‡ä»¶ä¸­ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä¸€ä¸ªHTTPåŒ…è¢«åˆ’åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ï¼šheaderç±»åž‹å’Œä»£ç ï¼Œcookieç±»åž‹å’Œä»£ç ï¼ŒHTTPå®žçŽ°ä»¥åŠåŒ…çš„æ–‡æ¡£ã€‚ 1234- doc.go // package documentation- headers.go // HTTP headers types and code- cookies.go // HTTP cookies types and code- http.go // HTTP client implementation, request and response types, etc. ####ä¿æŒç±»åž‹é è¿‘ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬è¦è®©ç±»åž‹å®šä¹‰é è¿‘ä»–ä½¿ç”¨çš„åœ°æ–¹ã€‚è¿™å¯ä»¥å¾ˆæ–¹ä¾¿ç»´æŠ¤äººå‘˜ï¼ˆä¸ä»…ä»…æ˜¯åŽŸå§‹ä½œè€…ï¼‰å‘çŽ°ç±»åž‹ã€‚å¯¹äºŽä¸€ä¸ªHeaderç±»åž‹ï¼Œä¸€ä¸ªå¥½çš„å®žçŽ°æ˜¯æŠŠä»–æ”¾åœ¨header.goæ–‡ä»¶ä¸­ã€‚ 12345$ cat headers.gopackage http// Header represents an HTTP header.type Header struct &#123;...&#125; å°½ç®¡ï¼ŒGoè¯­è¨€ä¸é™åˆ¶ä½ åœ¨ä½•å¤„å®šä¹‰ä½ çš„ç±»åž‹ï¼Œé€šå¸¸æˆ‘ä»¬æœ€å¥½æ˜¯å°†æ ¸å¿ƒç±»åž‹æ”¾åœ¨æ–‡ä»¶çš„é¡¶éƒ¨ã€‚ æ ¹æ®åŠŸèƒ½ç»„ç»‡ä»£ç é€šå¸¸åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å°†ç±»åž‹æ”¾åœ¨ä¸€ä¸ªå«åšmodelsæˆ–è€…typesçš„åŒ…ä¸­ã€‚ä½†åœ¨Goè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬ä¾æ®ä»–çš„åŠŸèƒ½æ¥ç»„ç»‡ä»£ç  1234package models // DON'T DO IT!!!// User represents a user in the system.type User struct &#123;...&#125; Userç±»åž‹åº”è¯¥æ”¾åœ¨æœåŠ¡å±‚åŒ…ä¸­ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªmodelsåŒ…ï¼Œç„¶åŽè®©å°†æ‰€æœ‰å®žä½“ç±»åž‹å®šä¹‰åœ¨å…¶ä¸­ã€‚ 12345678package mngtservice// User represents a user in the system.type User struct &#123;...&#125;func UsersByQuery(ctx context.Context, q *Query) ([]*User, *Iterator, error)func UserIDByEmail(ctx context.Context, email string) (int64, error) ä½¿ç”¨godocä¸€ä¸ªæ¯”è¾ƒå¥½çš„åšæ³•æ˜¯ï¼Œåœ¨è®¾è®¡ä½ çš„åŒ…æŽ¥å£é˜¶æ®µï¼Œç”¨godocæ¥å®šä¹‰ä½ å°†è¦è®¾è®¡çš„æ¦‚å¿µã€‚æœ‰æ—¶ï¼Œå¯è§†åŒ–å¯¹è®¾è®¡ä¹Ÿæœ‰å½±å“ã€‚Godocæ˜¯ç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªåŒ…çš„ä¸€ä¸ªæ–¹å¼ï¼Œå› æ­¤ï¼Œä½ éœ€è¦ç¨ä½œè°ƒæ•´è®©ä»–ä»¬æ›´å®¹æ˜“è¢«æŽ¥å—ã€‚è¿è¡Œgodoc -http=&lt;hostport&gt;æ¥æœ¬åœ°å¯åŠ¨ä¸€ä¸ªgodocæœåŠ¡ æä¾›ä¸€äº›èŒƒåˆ—å¾ˆå¤šæ—¶å€™ï¼Œä½ ä¸å¯èƒ½å°†æ‰€æœ‰ç›¸å…³çš„ç±»åž‹æ”¾åœ¨ä¸€ä¸ªåŒ…ä¸­ã€‚æ‚¨å¯èƒ½å¸Œæœ›ä»Žå•ç‹¬çš„åŒ…å‘å¸ƒå…¬ç”¨æŽ¥å£çš„å…·ä½“å®žçŽ°ï¼Œæˆ–è€…è¿™äº›ç±»åž‹å¯èƒ½è¢«ç¬¬ä¸‰æ–¹åŒ…æ‰€æ‹¥æœ‰ã€‚æä¾›ä¸€äº›ä¾‹å­å¯ä»¥å¸®åŠ©ç”¨æˆ·åŽ»å‘çŽ°ã€ç†è§£å¦‚ä½•ä½¿ç”¨ä»–ä»¬ã€‚ 123$ godoc cloud.google.com/go/datastorefunc NewClient(ctx context.Context, projectID string, opts ...option.ClientOption) (*Client, error)... NewClient works with option.ClientOptions but it is neither the datastore package nor the option package that export all the option types. 123$ godoc google.golang.org/extraoptionfunc WithCustomValue(v string) option.ClientOption... å¦‚æžœä½ çš„APIéœ€è¦å¼•å…¥è®¸å¤šéžæ ‡å‡†çš„åŒ…ï¼Œé€šå¸¸æä¾›ä¸€äº›å¯è¿è¡Œçš„ä»£ç æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åšæ³•ã€‚ åŒ…å‘½ååŒ…çš„åç§°å’Œè·¯å¾„å³æ˜¯åŒ…çš„é‡è¦æ ‡è¯†åŒæ—¶ä¹Ÿè¡¨ç¤ºåŒ…ä¸­æ‰€å«å†…å®¹ã€‚è§„èŒƒçš„å‘½åä¸ä»…èƒ½æé«˜ä½ çš„ä»£ç è´¨é‡è€Œä¸”å¯ä»¥æä¾›ä½ çš„ç”¨æˆ·çš„ä»£ç è´¨é‡ã€‚ å°å†™åŒ…åå¿…é¡»å°å†™ã€‚ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿ã€é©¼å³°åœ¨ä½ çš„åŒ…åä¸­ã€‚comprehensive guideè¿™è¾¹åšå®¢æœ‰è®¸å¤šå…³äºŽåŒ…å‘½åçš„èŒƒä¾‹ã€‚ ç®€çŸ­ï¼Œä½†æ˜¯è¯­æ„æ˜Žç¡®åŒ…ååº”è¯¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯æ˜¯å”¯ä¸€ä¸”è¯­æ„æ˜Žç¡®çš„ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŠ¥åå°±èƒ½äº†è§£åˆ°ä»–çš„ç”¨é€”ã€‚ é¿å…è¿‡äºŽå®½æ³›çš„åŒ…åï¼Œå¦‚ï¼šcommonã€utilã€‚ 1import "pkgs.org/common" // DON'T!!! åœ¨å¯èƒ½å¯¼å…¥ç›¸åŒåŒ…çš„æƒ…å†µä¸‹é¿å…é‡å¤çš„å‘½åã€‚ å¦‚æžœä½ ä¸èƒ½é¿å…ç³Ÿç³•çš„å‘½åï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä½ çš„ä»£ç ç»„ç»‡ç»“æž„å‡ºçŽ°äº†é—®é¢˜ã€‚ å¯¼å…¥è·¯å¾„ç®€æ´é¿å…å°†è‡ªå®šä¹‰å­˜å‚¨ç»“æž„æš´éœ²ç»™ç”¨æˆ·ã€‚åƒGOPATHä¸€æ ·ã€‚é¿å…åœ¨ä½ çš„å¯¼å…¥è·¯å¾„ä¸­å‡ºçŽ°src/ã€pkg/ç­‰ã€‚ 123github.com/user/repo/src/httputil // DON'T DO IT, AVOID SRC!!github.com/user/repo/gosrc/httputil // DON'T DO IT, AVOID GOSRC!! ä¸è¦ä½¿ç”¨å¤æ•°åœ¨Goè¯­è¨€ä¸­ï¼ŒåŒ…åä¸è¦ä½¿ç”¨å¤æ•°ã€‚å¯¹äºŽè®¸å¤šå…¶ä»–è¯­è¨€çš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œè¿™å¾ˆæƒŠè®¶ï¼Œä»–ä»¬ä¸€ç›´ä½¿ç”¨å¤æ•°æ¥å‘½åã€‚ä¸æ˜¯ä½¿ç”¨httputilsï¼Œè€Œç”¨httputilã€‚ 1package httputils // DON'T DO IT, USE SINGULAR FORM!! é‡å‘½åéœ€è¦éµå¾ªç›¸åŒçš„è§„åˆ™å‡å¦‚ä½ å¯¼å…¥å¤šä¸ªå…·æœ‰ç›¸åŒåå­—çš„åŒ…ï¼Œä½ å¯ä»¥é‡å‘½ååŒ…çš„åå­—ã€‚é‡å‘½ååº”è¯¥ä½¿ç”¨ç›¸åŒçš„è§„åˆ™ã€‚å…³äºŽé‡å‘½åæ²¡æœ‰å…·ä½“çš„è§„åˆ™ã€‚å‡å¦‚ä½ é‡å‘½åä¸€ä¸ªæ ‡å‡†åº“åï¼Œæœ€å¥½åœ¨å‰é¢åŠ ä¸Šgoä»¥æ ‡è¯†è¿™æ˜¯Goæ ‡å‡†åº“çš„åŒ…ã€‚å¦‚ï¼šgourlï¼Œgoioutilã€‚ 12345import ( gourl "net/url" "myother.com/url")]]></content>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2018-å­¦ä¹ æ—¥è®°]]></title>
    <url>%2F2018%2F03%2F01%2F2018-%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[2018-03-06 ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹ 2018-04-13 ã€ŠWeb Development With Goã€‹ 2018-04-20 ã€Šä¸‰ä½“ã€‹]]></content>
      <tags>
        <tag>å­¦ä¹ å­£</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoå»ºç«™ä¹‹è·¯]]></title>
    <url>%2F2018%2F02%2F06%2Fhexo%E5%BB%BA%E7%AB%99%E4%B9%8B%E8%B7%AF%2F</url>
    <content type="text"><![CDATA[å‰å› å‰ä¸€æ®µæ—¶é—´ï¼ŒæŠ˜è…¾äº†ä¸€ä¸‹ï¼Œæžäº†ä¸ªè‡ªå·±çš„åšå®¢ã€‚åŸºäºŽHexoï¼Œç½‘ä¸Šæœ‰ä¸€å¤§å †æ•™ç¨‹ï¼Œä¸€æ­¥æ­¥æ•™ä½ æ€Žä¹ˆæ¥æ­å»ºä¸€ä¸ªè‡ªå·±çš„åšå®¢ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œç™¾åº¦ï¼Œå½“ç„¶å…¶ä¸­ä¹Ÿé‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚å…ˆè¯´ä¸‹æˆ‘çš„æœ€ç»ˆæ–¹æ¡ˆæŠŠHexo + Nextä¸»é¢˜ + Travis CIè‡ªåŠ¨åŒ–éƒ¨ç½² + GitHubPages &amp; CodingPagesåŒæ‰˜ç®¡ã€‚ Travis CIè‡ªåŠ¨åŒ–éƒ¨ç½²Travis CIå¯ä»¥è‡ªåŠ¨ç›‘å¬ä»£ç å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨ç¼–è¯‘ï¼Œå‘å¸ƒã€‚æ‰€ä»¥è¯´ï¼Œæ¯æ¬¡ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æºä»£ç pushåˆ°githubï¼ŒTravis CIä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å‘å¸ƒï¼Œéžå¸¸æ–¹ä¾¿ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªåˆ†æ”¯ï¼š blog-sourceâ€”â€”ç”¨äºŽæ‰˜ç®¡æˆ‘ä»¬æºä»£ç  masterâ€”â€”ç”¨äºŽå‘å¸ƒä»£ç  ä¸æ¸…æ¥šçš„åŒå­¦å¯ä»¥è‡ªè¡Œç™¾åº¦å¦‚ä½•ç”¨Travis CIè‡ªåŠ¨åŒ–å‘å¸ƒHexoåšå®¢ï¼Œç½‘ä¸Šæœ‰ä¸€äº›Travisè„šæœ¬ï¼Œæ¯”å¦‚ï¼š 123456789101112131415161718192021222324252627282930language: node_jsnode_js: stable# S: Build Lifecycleinstall: - npm install#before_script: # - npm install -g gulpscript: - hexo gafter_script: - cd ./public - git init - git config user.name "lifengsofts" - git config user.email "lifengsofts@gmail.com" - git add . - git commit -m "Update docs" - git push --force --quiet "https://$&#123;GH_TOKEN&#125;@$&#123;GH_REF&#125;" master:master# E: Build LifeCyclebranches: only: - blog-sourceenv: global: - GH_REF: github.com/lifengsofts/lifengsofts.github.io.git ç®€å•è§£é‡Šä¸‹è¿™æ®µä»£ç æŠŠï¼š 12language: node_jsnode_js: stable è¿™æ®µæ˜¯æŒ‡å®šä½¿ç”¨node.jsç‰ˆæœ¬ 123# S: Build Lifecycleinstall: - npm install æ ¹æ®package.jsonå®‰è£…node.jsä¾èµ– 123456branches: only: - blog-sourceenv: global: - GH_REF: github.com/lifengsofts/lifengsofts.github.io.git æŒ‡å®šéœ€è¦ç¼–è¯‘çš„sourceåˆ†æ”¯ 12script: - hexo g æ‰§è¡Œå‘½ä»¤ï¼Œç”ŸæˆHexoé™æ€æ–‡ä»¶ 123456789after_script: - cd ./public - git init - git config user.name "lifengsofts" - git config user.email "lifengsofts@gmail.com" - git add . - git commit -m "Update docs" - git push --force --quiet "https://$&#123;GH_TOKEN&#125;@$&#123;GH_REF&#125;" master:master# E: Build LifeCycle è¿™æ®µå¤æ‚ä¸€ç‚¹ï¼Œæ„æ€æ˜¯ï¼Œè¿›å…¥Hexoé™æ€å‘å¸ƒæ–‡ä»¶ï¼Œé…ç½®githubä¿¡æ¯ï¼Œé€šè¿‡git pushæŽ¨é€åˆ°masteråˆ†æ”¯ï¼Œè¿™æ ·å°±æžå®šäº†ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ ç™¾åº¦sitemapä¸ŽSEOä¼˜åŒ–å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™æ ·æˆ‘ä»¬çš„åšå®¢å°±å»ºç«‹å¥½äº†ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ï¼Œå¯ä»¥ç»‘å®šè‡ªå·±çš„åŸŸåä¿¡æ¯ï¼Œå¯æ˜¯é‡åˆ°ä¸¤ä¸ªé—®é¢˜ã€‚ æ—¢ç„¶æˆ‘ä»¬åšäº†åšå®¢ï¼Œå½“ç„¶æ˜¯å¸Œæœ›å¯ä»¥è®©æ›´å¤šçš„äººè®¿é—®åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšSEOä¼˜åŒ–ï¼Œæˆ‘ä»¬å¸Œæœ›è‡ªå·±çš„ç½‘ç«™å¯ä»¥è¢«ç™¾åº¦ï¼ŒGoogleç­‰æœç´¢å¼•æ“Žæ”¶å½• GitHubæœåŠ¡å™¨æ˜¯åœ¨å›½å¤–çš„ï¼Œå›½å†…è®¿é—®å¾ˆæ…¢ï¼Œæœ‰æ—¶å€™ç”šè‡³éœ€è¦ç¿»å¢™æ‰èƒ½æ‰“å¼€ ç™¾åº¦æœ‰ä¸‰ç§è‡ªåŠ¨æäº¤æ–¹å¼ï¼šä¸»åŠ¨æŽ¨é€, è‡ªåŠ¨æŽ¨é€, sitemapï¼Œä¸€ä¸ªä¸ªè¯´ï¼Œæ¯ä¸ªé‡Œé¢éƒ½æœ‰å‘ ä¸»åŠ¨æäº¤ç½‘ä¸Šä¸€ä½å¤§ç¥žï¼Œå†™äº†ä¸€ä¸ªHexoçš„æ’ä»¶hexo-baidu-url-submit å®‰è£…: Hexoæ ¹ç›®å½•ï¼Œå®‰è£…æ­¤æ’ä»¶1npm install hexo-baidu-url-submit --save é…ç½®: åŒæ ·åœ¨æ ¹ç›®å½•ä¸‹ï¼ŒæŠŠä»¥ä¸‹å†…å®¹é…ç½®åˆ°_config.ymlæ–‡ä»¶ä¸­12345baidu_url_submit: count: 3 ## æ¯”å¦‚3ï¼Œä»£è¡¨æäº¤æœ€æ–°çš„ä¸‰ä¸ªé“¾æŽ¥ host: simonblog.cn ## åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå token: your_token ## è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥ï¼Œ è¯·ä¸è¦å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ! path: baidu_urls.txt ## æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ï¼Œ æ–°é“¾æŽ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ åŸŸåé…ç½®ï¼šåŒæ ·åœ¨_config.ymlæ–‡ä»¶ä¸­1234# URLurl: http://simonblog.cnroot: /permalink: :year/:month/:day/:title/ ä¸€å®šè¦æ³¨æ„ï¼Œä½ é…ç½®çš„åŸŸåå¿…é¡»ä¸Žä½ åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸåä¸€è‡´ï¼Œå¦‚æžœæœ‰wwwå°±éƒ½è¦æœ‰ï¼Œå¦‚æžœæ²¡æœ‰å°±éƒ½æ²¡æœ‰ æœ€åŽï¼ŒåŠ å…¥æ–°çš„deployer1234567# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: - type: git repo: github: https://__GH_TOKEN__@github.com/tjumoon/tjumoon.github.io.git,master - type: baidu_url_submitter æ‰§è¡Œhexo deployçš„æ—¶å€™å°±ä¼šä¸»åŠ¨æäº¤ä½ çš„sitemap ä½†æ˜¯ï¼Œæˆ‘è¯•äº†åŠå¤©ï¼Œå‘çŽ°æ²¡æœ‰æäº¤ï¼Œä»€ä¹ˆåŽŸå› ï¼Œå¥½å¿§ä¼¤ï¼Œå¤§ç¥žçš„ä»£ç æœ‰bugï¼ŸæŸ¥ä»£ç æŠŠï¼ åœ¨hexo-baidu-url-submitçš„index.jsä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° 12hexo.extend.generator.register('baidu_url_generator', require('./lib/generator'));hexo.extend.deployer.register('baidu_url_submitter', require('./lib/submitter')); åœ¨æ‰§è¡Œhexo generatoræ—¶åŠ è½½äº†generatoræ¨¡å— åœ¨æ‰§è¡Œhexo deployæ—¶åŠ è½½äº†submitteræ¨¡å— ç»§ç»­çœ‹generatorå¹²äº†ä»€ä¹ˆ 1234567891011121314151617181920212223242526272829303132module.exports = function (locals) &#123; var log = this.log; var config = this.config; var count = config.baidu_url_submit.count; var urlsPath = config.baidu_url_submit.path; log.info("Generating Baidu urls for last " + count + " posts"); // get last posts var urls = [].concat(locals.posts.toArray()) .map(function(post) &#123; return &#123; "date": post.date, "permalink": post.permalink &#125; &#125;) .sort(function(a, b) &#123; return b.date - a.date; &#125;) .slice(0, count) .map(function(post) &#123; return post.permalink &#125;) .join('\n'); log.info("Posts urls generated in " + urlsPath + "\n" + urls); return &#123; path: urlsPath, data: urls &#125;;&#125;; å…¶å®žå°±æ˜¯è¯»å–ä½ _postsé‡Œçš„æ–‡ä»¶ï¼Œç”Ÿæˆbaidu_urls.txt å†çœ‹submitteré‡Œåšäº†ä»€ä¹ˆ 12345678910111213141516171819202122232425262728var pathFn = require('path');var fs = require('fs');var XMLHttpRequest = require("xmlhttprequest").XMLHttpRequest;module.exports = function(args) &#123; var log = this.log; var config = this.config; var urlsPath = config.baidu_url_submit.path; var host = config.baidu_url_submit.host; var token = config.baidu_url_submit.token; var publicDir = this.public_dir; var baiduUrlsFile = pathFn.join(publicDir, 'baidu_urls.txt'); var urls = fs.readFileSync(baiduUrlsFile, 'utf8'); log.info("Submitting urls \n" + urls) var target = "http://data.zz.baidu.com/urls?site=" + host + "&amp;token=" + token; var xhr = new XMLHttpRequest(); xhr.open('POST', target, false); xhr.setRequestHeader('Content-type', 'text/plain'); xhr.onload = function () &#123; console.log(this.responseText); &#125;; xhr.send(urls);&#125;; å°±æ˜¯è¯»å–baidu_urls.txt,é€šè¿‡xhræŽ¨é€ç»™ç™¾åº¦ã€‚ å¥½å§ï¼Œé—®é¢˜æ‰¾åˆ°äº†ã€‚ 123456789101112script: - hexo g after_script: - cd ./public - git init - git config user.name "lifengsofts" - git config user.email "lifengsofts@gmail.com" - git add . - git commit -m "Update docs" - git push --force --quiet "https://$&#123;GH_TOKEN&#125;@$&#123;GH_REF&#125;" master:master# E: Build LifeCycle æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åªæ‰§è¡Œäº†hexo gï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œhexo deployï¼Œè€Œæ˜¯æ‰‹åŠ¨é€šè¿‡git pushå°†ä»£ç æäº¤åˆ°masteråˆ†æ”¯ï¼Œæ‰€ä»¥ï¼Œå¹¶æ²¡æœ‰åŠ è½½submitteræ¨¡å—ï¼Œæ‰€ä»¥æ ¹æœ¬å°±æ²¡æœ‰æäº¤ã€‚ æœ€ç»ˆæˆ‘çš„é…ç½®æ–‡ä»¶ _config.yml 1234567891011121314# Baidu sitemapbaidu_url_submit: count: 10 ## æäº¤æœ€æ–°çš„ä¸€ä¸ªé“¾æŽ¥ host: simonblog.cn ## åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå token: your-token ## è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥ï¼Œ æ‰€ä»¥è¯·ä¸è¦æŠŠåšå®¢æºä»£ç å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ! path: baidu_urls.txt ## æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ï¼Œ æ–°é“¾æŽ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: - type: git repo: github: https://__GH_TOKEN__@github.com/tjumoon/tjumoon.github.io.git,master - type: baidu_url_submitter æˆ‘ä»¬æ¥çœ‹ä¸‹hexo deployåšäº†ä»€ä¹ˆï¼Œå…¶å®žåšäº†ä¸¤ä»¶äº‹ æäº¤æœ¬åœ°æ–‡ä»¶åˆ°masteråˆ†æ”¯ æ‰§è¡Œbaidu_url_submitter .travis.yml 1234567891011121314151617181920212223242526language: node_jsnode_js: stable# S: Build Lifecycleinstall: - npm installbefore_script: - git config user.name "tjumoon" - git config user.email "simon_yang@aliyun.com" - sed -i "s/__GH_TOKEN__/$&#123;GH_TOKEN&#125;/" _config.yml script: - hexo clean - hexo gafter_success: - hexo deploybranches: only: - blog-sourceenv: global: - GH_REF: github.com/tjumoon/tjumoon.github.io.git è‡ªåŠ¨æäº¤è‡ªåŠ¨æäº¤æ¯”è¾ƒç®€å•ï¼Œåœ¨nextä¸»é¢˜é…ç½®_config.ymlä¸­è®¾ç½® 1baidu_push: true ç»§ç»­çœ‹ä»£ç ï¼šthemes\next\layout\_third-party\seo\baidu-push.swig 12345678910111213141516&#123;% if theme.baidu_push %&#125;&lt;script&gt;(function()&#123; var bp = document.createElement('script'); var curProtocol = window.location.protocol.split(':')[0]; if (curProtocol === 'https') &#123; bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'; &#125; else &#123; bp.src = 'http://push.zhanzhang.baidu.com/push.js'; &#125; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(bp, s);&#125;)();&lt;/script&gt;&#123;% endif %&#125; è¿™é‡Œæ·»åŠ äº†ä¸€æ®µå‘é€çš„jsä»£ç ï¼Œä¸€å®šè¦æ³¨æ„ä½ é…ç½®çš„åŸŸåå¿…é¡»è¦ä¸Žä½ ç™¾åº¦ç«™é•¿åœ¨çš„åŸŸåä¸€è‡´ sitemapç™¾åº¦ç«™é•¿å¹³å°ï¼Œæäº¤sitemapåŽï¼Œç™¾åº¦ä¼šè‡ªåŠ¨åŽ»çˆ¬å–ä½ çš„sitemap è¿™é‡Œéœ€è¦å®‰è£…æ’ä»¶ 12npm install hexo-generator-baidu-sitemap --savenpm install hexo-generator-sitemap --save åŒæ ·ï¼Œè¿™ä¸¤ä¸ªæ’ä»¶ä¼šåœ¨hexo generatorçš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºbaidusitemap.xmlï¼Œsitemap.xml æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ç™¾åº¦ç«™é•¿ä¸Šæäº¤sitemapå§ ä½†æ˜¯ï¼Œæ¯æ¬¡éƒ½æ˜¯æŠ“åŽ»å¤±è´¥ï¼Œ403 Forbiddenï¼Œä»€ä¹ˆåŽŸå› ã€‚ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘çŽ°githubé»˜è®¤ä¼šå±è”½æ¥è‡ªç™¾åº¦çš„çˆ¬è™«ã€‚è¿™æ€Žä¹ˆè§£å†³â€¦.. å¥½å§ï¼Œæ—¢ç„¶githubå±è”½ç™¾åº¦ï¼Œé‚£æˆ‘ä»¬å°±å¢žåŠ ä¸€ä¸ªæ‰˜ç®¡å¹³å°â€”â€”Codingï¼ŒåŸºæœ¬é…ç½®æ€è·¯å’Œgithubä¸€è‡´ï¼Œæœ€ç»ˆçš„é…ç½®è„šæœ¬ _config.yml 123456789101112131415# Baidu sitemapbaidu_url_submit: count: 10 ## æäº¤æœ€æ–°çš„ä¸€ä¸ªé“¾æŽ¥ host: simonblog.cn ## åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå token: your-token ## è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥ï¼Œ æ‰€ä»¥è¯·ä¸è¦æŠŠåšå®¢æºä»£ç å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ! path: baidu_urls.txt ## æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ï¼Œ æ–°é“¾æŽ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: - type: git repo: github: https://__GH_TOKEN__@github.com/tjumoon/tjumoon.github.io.git,master coding: https://simon_yang:__CODING_TOKEN__@git.coding.net/simon_yang/Blog.git,master - type: baidu_url_submitter .travis.yml 123456789101112131415161718192021222324252627language: node_jsnode_js: stable# S: Build Lifecycleinstall: - npm installbefore_script: - git config user.name "tjumoon" - git config user.email "simon_yang@aliyun.com" - sed -i "s/__GH_TOKEN__/$&#123;GH_TOKEN&#125;/" _config.yml - sed -i "s/__CODING_TOKEN__/$&#123;CODING_TOKEN&#125;/" _config.ymlscript: - hexo clean - hexo gafter_success: - hexo deploybranches: only: - blog-sourceenv: global: - GH_REF: github.com/tjumoon/tjumoon.github.io.git ç„¶åŽï¼Œæˆ‘ä»¬åœ¨åŸŸåæœåŠ¡å™¨ä¸Šé…ç½®ï¼Œå›½å†…æµé‡è®¿é—®CodingPageï¼Œæµ·å¤–æµé‡è®¿é—®GithubPageï¼Œå®Œç¾Žè§£å†³ç™¾åº¦çˆ¬è™«é—®é¢˜ï¼ŒåŒæ—¶ç½‘ç«™çš„æ‰“å¼€é€Ÿåº¦å¤§å¤§æå‡äº† æœ€åŽæœ¬ç¯‡æ–‡ç« ï¼Œä¸æ˜¯ä¸€ä¸ªæ­å»ºæ•™ç¨‹ï¼Œåªæ˜¯åœ¨æ­å»ºè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è§£å†³çš„ä¸€äº›æ€è·¯]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€è½¬è½½ã€‘RxSwift-é‚£äº›éš¾ä»¥ç†è§£çš„ç»†èŠ‚]]></title>
    <url>%2F2018%2F01%2F30%2FRxSwift-%E9%82%A3%E4%BA%9B%E9%9A%BE%E4%BB%A5%E7%90%86%E8%A7%A3%E7%9A%84%E7%BB%86%E8%8A%82%2F</url>
    <content type="text"><![CDATA[æ­¤æ–‡è½¬è½½è‡³ã€ç”°è…¾é£žçš„åšå®¢ã€‘ ä¸Šä¸€ç¯‡æ–‡ç« RxSwift-å„ç§æ¦‚å¿µè§£è¯»å†…å®¹æ¯”è¾ƒå¤šï¼Œæ–‡ç« ç®€ç›´æ˜¯å¤ªé•¿äº†ï¼Œæˆ‘éƒ½éš¾ä»¥åšæŒçœ‹ä¸‹åŽ»ðŸ˜‚ï¼Œå»ºè®®å¤§å®¶ç²—ç•¥è¯»ä¸€éå°±è¡Œäº†ï¼Œç”¨åˆ°çš„æ—¶å€™æ¥æŸ¥ä¸€ä¸‹ï¼Œæ…¢æ…¢åœ°å°±æŽŒæ¡äº†ã€‚ è¿™ç¯‡æ–‡ç« æŽ¥ç€ä¸Šç¯‡æ–‡ç« ï¼Œä¸»è¦æ¥æ·±å…¥äº†è§£ä¸€äº›RxSwiftå®žæˆ˜ä¸­ç”¨åˆ°çš„ä¸€äº›é‡è¦çŸ¥è¯†ç‚¹ï¼Œè¿™é‡Œé¢æœ‰å¾ˆå¤šè‡ªå·±çš„ç†è§£å’Œæ€è€ƒï¼ŒåŒ…å«å¾ˆå¤šç½‘ä¸Šå‡ ä¹Žæ”¶ä¸åˆ°çš„å†…å®¹ï¼Œå¸Œæœ›ä¼šæ˜¯å¤§å®¶ç ”ç©¶å®˜æ–¹ä¾‹å­çš„ä¸€ä¸ªé‡è¦å‚è€ƒèµ„æ–™ï¼Œæ–‡ç« ä¸­ä¸å…ä¼šæœ‰äº›é”™è¯¯çš„åœ°æ–¹ï¼Œä¹Ÿè¯·å¤§å®¶èƒ½å¤šå¤šç•™è¨€äº¤æµï¼Œä¸€èµ·æˆé•¿ã€‚è¿™ä¸¤ç¯‡æ–‡ç« è¿‡åŽï¼Œå‡†å¤‡å†™å®žæˆ˜æ•™ç¨‹ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šå…³æ³¨å§ã€‚letâ€™s go Rxç³»åˆ—çš„æ ¸å¿ƒå°±æ˜¯Observable Sequenceè¿™ä¸ªç›¸ä¿¡å¤§å®¶å¿ƒä¸­å·²ç»æœ‰æ‰€äº†è§£äº†ï¼Œè¿™é‡Œä¸å†å•°å—¦äº†ï¼Œå»ºè®®å¤§å®¶çœ‹çœ‹æˆ‘éƒ½ä¸Šä¸€ç¯‡æ–‡ç« åŽ»äº†è§£ä¸€ä¸‹ã€‚ Disposingå½“ç›‘å¬ä¸€ä¸ªäº‹ä»¶åºåˆ—çš„æ—¶å€™ï¼Œæœ‰æ¶ˆæ¯äº‹ä»¶æ¥äº†ï¼Œæˆ‘ä»¬åšæŸäº›äº‹æƒ…ã€‚ä½†æ˜¯è¿™ä¸ªäº‹ä»¶åºåˆ—ä¸å†å‘å‡ºæ¶ˆæ¯äº†ï¼Œæˆ‘ä»¬çš„ç›‘å¬ä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆå­˜åœ¨ä»·å€¼äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡Šæ”¾æˆ‘ä»¬è¿™äº›ç›‘å¬èµ„æºï¼Œå…¶å®žä¹Ÿå°±æ˜¯æ¯ç§ç¼–ç¨‹è¯­è¨€ä¸­çš„å†…å­˜èµ„æºé‡Šæ”¾ã€‚OCå’ŒSwiftä¸­ä¹Ÿä¸€æ ·ï¼Œåœ¨ä½ ä¸éœ€è¦ç”¨æŸäº›å˜é‡çš„æ—¶å€™ï¼Œä½ éœ€è¦æŠŠè¿™äº›å˜é‡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´é‡Šæ”¾æŽ‰ã€‚ é‡Šæ”¾æŸä¸€ä¸ªç›‘å¬çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è°ƒç”¨é‡Šæ”¾æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªè²Œä¼¼ä¸€èˆ¬ä¸å¸¸ç”¨ï¼š 12345678910// å…³äºŽschedulerï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹é¢è®²åˆ°let subscription = Observable&lt;Int&gt;.interval(0.3, scheduler: SerialDispatchQueueScheduler.init(internalSerialQueueName: "test")) .observeOn(MainScheduler.instance) //observeOnä¹Ÿä¼šåœ¨ä¸‹é¢è®²åˆ° .subscribe &#123; event in print(event)&#125; Thread.sleep(forTimeInterval: 2.0) subscription.dispose() 123456next(0)next(1)next(2)next(3)next(4)next(5) æ¯”å¦‚ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªsubscriptionç›‘å¬ï¼Œåœ¨ä¸¤ç§’ä»¥åŽæˆ‘ä»¬ä¸éœ€è¦äº†ï¼Œæ‰‹åŠ¨è°ƒç”¨dispose()æ–¹æ³•ï¼Œå°±èƒ½é‡Šæ”¾ç›‘å¬èµ„æºï¼Œä¸å†æ‰“å°ä¿¡æ¯ã€‚ä¸Šé¢çš„subscriptionä¸ä¼¦æ˜¯åœ¨å“ªä¸ªçº¿ç¨‹ä¸­ç›‘å¬ï¼Œå°±ç®—åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨çš„dispose()æ–¹æ³•ä¸€æ ·ä¼šé”€æ¯èµ„æºã€‚ Dispose Bagé™¤äº†ä¸Šé¢æ‰‹åŠ¨çš„æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯è‡ªåŠ¨çš„æ–¹å¼ï¼ŒæŽ¨èå¤§å®¶ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å°±å¥½åƒiOSä¸­çš„ARCæ–¹å¼ä¼¼å¾—ï¼Œä¼šè‡ªåŠ¨åŽ»é‡Šæ”¾èµ„æºã€‚ 1234567let disposeBag = DisposeBag() Observable&lt;Int&gt;.empty() .subscribe &#123; event in print(event) &#125; .addDisposableTo(disposeBag) å¦‚ä¸Šä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªdisposeBagæ¥ç››æ”¾æˆ‘ä»¬éœ€è¦ç®¡ç†çš„èµ„æºï¼Œç„¶åŽæŠŠæ–°å»ºçš„ç›‘å¬éƒ½æ”¾è¿›åŽ»ï¼Œä¼šåœ¨é€‚å½“çš„æ—¶å€™é”€æ¯è¿™äº›èµ„æºã€‚å¦‚æžœä½ éœ€è¦ç«‹å³é‡Šæ”¾èµ„æºåªéœ€è¦æ–°å»ºä¸€ä¸ªDisposeBag()ï¼Œé‚£ä¹ˆä¸Šä¸€ä¸ªDisposeBagå°±ä¼šè¢«é”€æ¯ã€‚ observeOn()å’ŒsubscribeOn()è¿™ä¸¤ä¸ªä¸œè¥¿å¯èƒ½å¾ˆå¤šäººçœ‹å®˜æ–¹æ–‡æ¡£è¯´çš„ä¸€å¤´é›¾æ°´ï¼Œå°±çŸ¥é“æœ€å¥½å¤šç”¨observeOn()ï¼Œä½†è¯´æ˜Žä¸äº†ä¸ºå•¥ã€‚ä¸‹é¢å’±ä»¬å°±è°ˆè°ˆè¿™ä¿©è´§åˆ°åº•æœ‰å•¥åŒºåˆ«ã€‚ åŒºåˆ«å…¶å®žæˆ‘æ„Ÿè§‰å…¶å®žå°±ä¸€å¥è¯ï¼ŒsubscribeOn()è®¾ç½®èµ·ç‚¹åœ¨å“ªä¸ªçº¿ç¨‹ï¼ŒobserveOn()è®¾ç½®äº†åŽç»­å·¥ä½œåœ¨å“ªä¸ªçº¿ç¨‹ã€‚ä¾‹å¦‚ï¼š 12345678someObservable .doOneThing() 1 .observeOn(MainRouteScheduler.instance) 2 .subscribeOn(OtherScheduler.instance) 3 .subscribeNext &#123; 4 ...... &#125; .addDisposableTo(disposeBag) æ‰€æœ‰åŠ¨ä½œéƒ½å‘ç”Ÿåœ¨å½“å‰çš„é»˜è®¤çº¿ç¨‹ observeOnè½¬æ¢çº¿ç¨‹åˆ°ä¸»çº¿ç¨‹ï¼Œä¸‹é¢æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­ subscribeOnè§„å®šåŠ¨ä½œä¸€å¼€å§‹ä¸æ˜¯å‘ç”Ÿåœ¨é»˜è®¤çº¿ç¨‹äº†ï¼Œè€Œæ˜¯åœ¨OtherScheduleräº†ã€‚ å¦‚æžœæˆ‘ä»¬ä¹‹å‰æ²¡æœ‰è°ƒç”¨observeOnï¼Œé‚£ä¹ˆè¿™è¾¹ä¼šåœ¨OtherSchedulerå‘ç”Ÿï¼Œä½†æ˜¯æˆ‘ä»¬å‰é¢è°ƒç”¨äº†observeOnï¼Œæ‰€ä»¥è¿™ä¸ªåŠ¨ä½œä¼šåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ã€‚ æ€»ç»“ä¸€ä¸‹ï¼šsubscribeOnåªæ˜¯å½±å“äº‹ä»¶é“¾å¼€å§‹é»˜è®¤çš„çº¿ç¨‹ï¼Œè€ŒobserveOnè§„å®šäº†ä¸‹ä¸€æ­¥åŠ¨ä½œå‘ç”Ÿåœ¨å“ªä¸ªçº¿ç¨‹ä¸­ã€‚ shareReplayå¯èƒ½ä½ çœ‹å®˜æ–¹demoçš„æ—¶å€™ï¼Œä¼šæœ‰è¿·æƒ‘ï¼Œä¸ºå•¥å¾ˆå¤šåºåˆ—åŽé¢ä¼šæœ‰shareReplay(1)å‘¢ï¼Ÿï¼Œæƒ³çš„å¤´æ˜è„‘èƒ€çš„ã€‚è¯·å…ˆçœ‹ä¸‹é¢ä¾‹å­ï¼š 123456789101112let testReplay = Observable.just("ðŸ˜‚") .map &#123; print($0) &#125; testReplay .subscribe &#123; event in print(event)&#125;.addDisposableTo(disposeBag) testReplay .subscribe &#123; event in print(event)&#125;.addDisposableTo(disposeBag) 123456ðŸ˜‚next(())completedðŸ˜‚next(())completed å¤§å®¶å‘çŽ°æ²¡ï¼Œmapå‡½æ•°æ‰§è¡Œäº†ä¸¤éï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™æˆ‘ä¸éœ€è¦mapå‡½æ•°é‡Œçš„ä¸œè¥¿æ‰§è¡Œä¸¤éï¼Œæ¯”å¦‚mapå‡½æ•°é‡Œé¢å¦‚æžœæ‰§è¡Œçš„æ˜¯ç½‘ç»œè¯·æ±‚ï¼Œæˆ‘åªéœ€è¦ä¸€æ¬¡è¯·æ±‚ç»“æžœä¾›å¤§å®¶ä½¿ç”¨å°±è¡Œäº†ï¼Œå¤šä½™çš„è¯·æ±‚æ²¡å•¥ç”¨ï¼Œæµªè´¹æ—¶é—´ã€‚æ‰€ä»¥è¿™æ—¶å€™å°±éœ€è¦shareReplay(1)äº†ã€‚è¿™é‡Œé¢çš„æ•°å­—ä¸€èˆ¬éƒ½æ˜¯1ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚ä½ å¯ä»¥æ”¹ä¸º2ï¼Œ3çœ‹çœ‹ç»“æžœæœ‰å•¥ä¸åŒå“¦ã€‚ 12345678910111213let testReplay = Observable.just("ðŸ˜‚") .map &#123; print($0) &#125; .shareReplay(1) testReplay .subscribe &#123; event in print(event)&#125;.addDisposableTo(disposeBag) testReplay .subscribe &#123; event in print(event)&#125;.addDisposableTo(disposeBag) 12345ðŸ˜‚ //åªæ‰§è¡Œäº†ä¸€æ¬¡next(())completednext(())completed è‡ªå®šä¹‰operatorè‡ªå®šä¹‰æ“ä½œç¬¦å¾ˆç®€å•ï¼Œå®˜æ–¹æŽ¨èå°½é‡ç”¨æ ‡å‡†çš„æ“ä½œç¬¦ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„æ“ä½œç¬¦ï¼Œæ–‡æ¡£ä¸Šè¯´æœ‰ä¸¤ç§æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬åªè¯´ä¸€ä¸‹æœ€å¸¸ç”¨çš„ä¸€ç§æ–¹æ³•ã€‚ ä¾‹å¦‚æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªmapæ“ä½œç¬¦ï¼š 12345678910111213141516171819extension ObservableType &#123; func myMap&lt;R&gt;(transform: E -&gt; R) -&gt; Observable&lt;R&gt; &#123; return Observable.create &#123; observer in let subscription = self.subscribe &#123; e in switch e &#123; case .next(let value): let result = transform(value) observer.on(.next(result)) case .error(let error): observer.on(.error(error)) case .completed: observer.on(.completed) &#125; &#125; return subscription &#125; &#125;&#125; å‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå…¶ä¸­é—­åŒ…å‚æ•°æ˜¯Eç±»åž‹è¿”å›žå€¼æ˜¯Rç±»åž‹ï¼Œmapå‡½æ•°çš„è¿”å›žå€¼æ˜¯ä¸€ä¸ªObservableç±»åž‹ã€‚ DriverDriveræ˜¯å•¥ä¸œä¸œï¼ŸDriveråŠŸèƒ½å¾ˆåŠï¼Œè®²è§£Driverä¹‹å‰æˆ‘ä»¬çŽ°åœ¨çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚ 12345678910111213141516let results = query.rx.text .throttle(0.3, scheduler: MainScheduler.instance) .flatMapLatest &#123; query in fetchAutoCompleteItems(query) &#125;results .map &#123; "\($0.count)" &#125; .bindTo(resultCount.rx.text) .addDisposableTo(disposeBag)results .bindTo(resultsTableView.rx.items(cellIdentifier: "Cell")) &#123; (_, result, cell) in cell.textLabel?.text = "\(result)" &#125; .addDisposableTo(disposeBag) é¦–å…ˆåˆ›å»ºä¸€ä¸ªå¯ç›‘å¬åºåˆ—resultsï¼Œå…¶ä¸­flatMapLatestæ€Žä¹ˆç”¨æˆ‘ä»¬ä¸‹é¢è®² ç„¶åŽå°†resultsç»‘å®šåˆ°resultCount.rx.textä¸Š å°†resultsç»‘å®šåˆ°resultsTableViewä¸Š ä¸Šé¢ç¨‹åºä¼šæœ‰ä¸‹é¢å‡ ä¸ªå¼‚å¸¸æƒ…å†µ å¦‚æžœä¸Šé¢fetchAutoCompleteItemså‡ºé”™äº†ï¼Œé‚£ä¹ˆä»–ç»‘å®šçš„UIå°†ä¸å†æ”¶åˆ°ä»»ä½•äº‹ä»¶æ¶ˆæ¯ å¦‚æžœä¸Šé¢fetchAutoCompleteItemsæ˜¯åœ¨åŽå°æŸä¸ªçº¿ç¨‹ä¸­è¿è¡Œçš„ï¼Œé‚£ä¹ˆäº‹ä»¶ç»‘å®šä¹Ÿæ˜¯å‘ç”Ÿåœ¨åŽå°æŸä¸ªçº¿ç¨‹ï¼Œè¿™æ ·æ›´æ–°UIçš„æ—¶å€™ä¼šé€ æˆcrash æœ‰ä¸¤æ¬¡ç»‘å®šfetchAutoCompleteItemsä¼šæ‰§è¡Œä¸¤æ¬¡ å½“ç„¶é’ˆå¯¹ä¸Šé¢é—®é¢˜æˆ‘ä»¬ä¹Ÿæœ‰è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¥žå™¨shareReplay(1)ä¿è¯ä¸ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨observeOn()ä¿è¯åŽé¢æ‰€æœ‰æ“ä½œåœ¨ä¸»çº¿ç¨‹å®Œæˆã€‚ 12345678910111213141516171819let results = query.rx.text .throttle(0.3, scheduler: MainScheduler.instance) .flatMapLatest &#123; query in fetchAutoCompleteItems(query) .observeOn(MainScheduler.instance) .catchErrorJustReturn([]) &#125; .shareReplay(1) results .map &#123; "\($0.count)" &#125; .bindTo(resultCount.rx.text) .addDisposableTo(disposeBag)results .bindTo(resultTableView.rx.items(cellIdentifier: "Cell")) &#123; (_, result, cell) in cell.textLabel?.text = "\(result)" &#125; .addDisposableTo(disposeBag) ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Driver 1234567891011121314151617let results = query.rx.text.asDriver() //è½¬æ¢æˆä¸€ä¸ªDriveråºåˆ— .throttle(0.3, scheduler: MainScheduler.instance) .flatMapLatest &#123; query in fetchAutoCompleteItems(query) .asDriver(onErrorJustReturn: []) //å½“é‡è§é”™è¯¯éœ€è¦è¿”å›žä»€ä¹ˆ &#125; //ä¸éœ€è¦æ·»åŠ shareReplay(1)results .map &#123; "\($0.count)" &#125; .drive(resultCount.rx.text) //å’ŒbingTo()åŠŸèƒ½ä¸€æ · .addDisposableTo(disposeBag) results .drive(resultTableView.rx.items(cellIdentifier: "Cell")) &#123; (_, result, cell) in cell.textLabel?.text = "\(result)" &#125; .addDisposableTo(disposeBag) driveæ–¹æ³•åªèƒ½åœ¨Driveråºåˆ—ä¸­ä½¿ç”¨ï¼ŒDriveræœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š1 Driveråºåˆ—ä¸å…è®¸å‘å‡ºerrorï¼Œ2 Driveråºåˆ—çš„ç›‘å¬åªä¼šåœ¨ä¸»çº¿ç¨‹ä¸­ã€‚æ‰€ä»¥Driveræ˜¯è½¬ä¸ºUIç»‘å®šé‡èº«æ‰“é€ çš„ä¸œè¥¿ã€‚ä»¥ä¸‹æƒ…å†µä½ å¯ä»¥ä½¿ç”¨Driveræ›¿æ¢BindTo: ä¸èƒ½å‘å‡ºerror åœ¨ä¸»çº¿ç¨‹ä¸­ç›‘å¬ å…±äº«äº‹ä»¶æµ mapå’ŒflatMapä½•æ—¶ä½¿ç”¨å¤§å®¶çœ‹å®˜æ–¹Demoçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šè¿·æƒ‘ä¸ºå•¥æœ‰çš„åœ°æ–¹ä½¿ç”¨flatMapLatestä¸ºå•¥æœ‰äº›åœ°æ–¹ä½¿ç”¨mapå‘¢ï¼Ÿæ¯”å¦‚ä¸Šé¢é‚£ä¸ªDriveræ‰€ç”¨çš„ä¾‹å­ã€‚ mapå‡½æ•°ï¼ŒæŽ¥å—ä¸€ä¸ªRç±»åž‹çš„åºåˆ—ï¼Œè¿”å›žä¸€ä¸ªRç±»åž‹çš„åºåˆ—ï¼Œè¿˜æ˜¯åŽŸæ¥çš„åºåˆ— 1public func map&lt;R&gt;(_ transform: @escaping (Self.E) throws -&gt; R) -&gt; RxSwift.Observable&lt;R&gt; flatMapå‡½æ•°ï¼ŒæŽ¥æ”¶ä¸€ä¸ªOç±»åž‹çš„åºåˆ—ï¼Œè¿”å›žä¸€ä¸ªO.Eç±»åž‹çš„åºåˆ—ï¼Œä¹Ÿå°±æ˜¯æœ‰åŽŸæ¥åºåˆ—é‡Œå…ƒç´ ç»„æˆçš„æ–°åºåˆ—ã€‚ 1public func flatMap&lt;O : ObservableConvertibleType&gt;(_ selector: @escaping (Self.E) throws -&gt; O) -&gt; RxSwift.Observable&lt;O.E&gt; å…¶å®žè¿™é‡Œçš„mapå’ŒflatMapåœ¨swiftä¸­çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚mapå‡½æ•°å¯ä»¥å¯¹åŽŸæœ‰åºåˆ—é‡Œé¢çš„äº‹ä»¶å…ƒç´ è¿›è¡Œæ”¹é€ ï¼Œè¿”å›žçš„è¿˜æ˜¯åŽŸæ¥çš„åºåˆ—ã€‚è€ŒflatMapå¯¹åŽŸæœ‰åºåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œæ”¹é€ å’Œå¤„ç†ï¼Œæ¯ä¸€ä¸ªå…ƒç´ è¿”å›žä¸€ä¸ªæ–°çš„sequenceï¼Œç„¶åŽæŠŠæ¯ä¸€ä¸ªå…ƒç´ å¯¹åº”çš„sequenceåˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„sequenceåºåˆ—ã€‚ çœ‹ä¸‹é¢ä¾‹å­ï¼š 12345678let test = Observable.of("1", "2", "3", "4", "5") .map &#123; $0 + "TTF" &#125; test .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123451TTF2TTF3TTF4TTF5TTF æˆ‘ä»¬ä½¿ç”¨mapå¯¹åºåˆ—ä¸­æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œäº†å¤„ç†ï¼Œè¿”å›žçš„æ˜¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä½¿ç”¨flatMapéœ€è¦è¿”å›žçš„åºåˆ—ã€‚é‚£ä¹ˆä½¿ç”¨mapä¹Ÿè¿”å›žä¸€ä¸ªåºåˆ—çœ‹çœ‹ã€‚ 12345678let test = Observable.of("1", "2", "3", "4", "5") .map &#123; Observable.just($0) &#125;test .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 12345RxSwift.Just&lt;Swift.String&gt;RxSwift.Just&lt;Swift.String&gt;RxSwift.Just&lt;Swift.String&gt;RxSwift.Just&lt;Swift.String&gt;RxSwift.Just&lt;Swift.String&gt; çœ‹åˆ°ç»“æžœä¼šæ‰“å°å‡ºæ¯ä¸€ä¸ªåºåˆ—ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨merge()æ–¹æ³•å°†è¿™å‡ ä¸ªåºåˆ—è¿›è¡Œåˆå¹¶ 123456789let test = Observable.of("1", "2", "3", "4", "5") .map &#123; Observable.just($0) &#125; .merge() test .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 1234512345 åˆå¹¶ä¸ºä¸€ä¸ªæ–°åºåˆ—åŽæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸æ‰“å°å…ƒç´ äº†ã€‚ä¸‹é¢çœ‹çœ‹ä½¿ç”¨faltMap()å‡½æ•°å¹²è¿™ä»¶äº‹ 12345678let test = Observable.of("1", "2", "3", "4", "5") .flatMap &#123; Observable.just($0) &#125; test .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 1234512345 çœ‹ä¸‹å¯¹æ¯”æ˜¯ä¸æ˜¯ä¸€æ ·ï¼Œè¿™æ ·å­å¯¹æ¯”å°±æ¸…æ™°äº†å§ã€‚ mapå‡½æ•°åªèƒ½è¿”å›žåŽŸæ¥çš„é‚£ä¸€ä¸ªåºåˆ—ï¼Œé‡Œé¢çš„å‚æ•°çš„è¿”å›žå€¼è¢«å½“åšåŽŸæ¥åºåˆ—ä¸­æ‰€å¯¹åº”çš„å…ƒç´ ã€‚ flatMapå‡½æ•°è¿”å›žçš„æ˜¯ä¸€ä¸ªæ–°çš„åºåˆ—ï¼Œå°†åŽŸæ¥å…ƒç´ è¿›è¡Œäº†å¤„ç†ï¼Œè¿”å›žè¿™äº›å¤„ç†åŽçš„å…ƒç´ ç»„æˆçš„æ–°åºåˆ— mapå‡½æ•° + åˆå¹¶å‡½æ•° = flatMapå‡½æ•° flatMapå‡½æ•°åœ¨å®žé™…åº”ç”¨ä¸­æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦ç”¨åˆ°ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼Œç½‘ç»œè¯·æ±‚å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªè¯·æ±‚è¿‡ç¨‹è¿›è¡Œç›‘å¬ï¼Œç„¶åŽå¤„ç†é”™è¯¯ã€‚åªè¦ç»§ç»­ä»–è¿”å›žçš„æ˜¯ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚ 1234567validatedUsername = input.username .flatMapLatest &#123; username in return validationService.validateUsername(username) .observeOn(MainScheduler.instance) .catchErrorJustReturn(.failed(message: "Error contacting server")) &#125; .shareReplay(1) flatMapLatestå…¶å®žå°±æ˜¯flatMapçš„å¦ä¸€ä¸ªæ–¹å¼ï¼Œåªå‘é€æœ€åŽä¸€ä¸ªåˆè¿›æ¥çš„åºåˆ—äº‹ä»¶ã€‚ä¸Šé¢è®¤è¯usernameæ˜¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œå¤„ç†ã€‚ 12345validatedPassword = input.password .map &#123; password in return validationService.validatePassword(password) &#125; .shareReplay(1) è¿™ä¸ªpasswordä¸éœ€è¦åŽå°è”ç½‘è®¤è¯ï¼Œåªéœ€è¦è¿”å›žpasswordç¬¦åˆä¸ç¬¦åˆè¦æ±‚å°±è¡Œäº†ï¼Œè¿˜æ˜¯åŽŸæ¥çš„åºåˆ—å°±è¡Œäº†ã€‚ flatMapä¹Ÿè§£å†³äº†å†…åµŒå¤šä¸ªsubscribeçš„é—®é¢˜ï¼Œå®˜æ–¹ä¸å»ºè®®å†…åµŒå¤šä¸ªsubscribeã€‚æ¯”å¦‚ï¼š 1234567textField.rx_text.subscribe(onNext: &#123; text in performURLRequest(text).subscribe(onNext: &#123; result in ... &#125;) .addDisposableTo(disposeBag)&#125;).addDisposableTo(disposeBag) æ”¹å†™ä¸ºflatMap 123456textField.rx_text .flatMapLatest &#123; text in return performURLRequest(text) //å› ä¸ºflatMapè¿”å›žä¸€ä¸ªæ–°çš„sequence &#125; ... .addDisposableTo(disposeBag) å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬ç½‘ç»œè¯·æ±‚å¾—åˆ°jsonæ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨flatmapè¿›è¡Œåºåˆ—è½¬æ¢ï¼Œè§£æžæˆModelåºåˆ—ï¼Œç„¶åŽæˆ‘ä»¬è®¢é˜…è¿™ä¸ªå¸¦æœ‰Modelçš„åºåˆ—ï¼Œä»£ç å°±ä¼šå˜å¾—å¾ˆä¼˜é›…ã€‚å…·ä½“å¯ä»¥å‚è€ƒæ–‡ç« Moya+RxSwiftè¿›è¡Œæ›´ä¼˜é›…çš„ç½‘ç»œè¯·æ±‚ å¥½äº†ï¼Œç›¸ä¿¡å¤§å®¶å¯¹è¿™ä¿©è´§æœ‰äº†ä¸€ä¸ªæ¸…æ™°çš„è®¤è¯†äº†å§ã€‚ UIBindingObserverUIBindingObserverè¿™ä¸ªä¸œè¥¿å¾ˆæœ‰ç”¨çš„ï¼Œåˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„ç›‘å¬è€…ï¼Œæœ‰æ—¶å€™RxCocoa(RxSwiftzä¸­å¯¹UIKitçš„ä¸€ä¸ªæ‰©å±•åº“)ç»™çš„æ‰©å±•ä¸å¤Ÿæˆ‘ä»¬ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸€ä¸ªUITextFieldæœ‰ä¸ªisEnabledå±žæ€§ï¼Œæˆ‘æƒ³æŠŠè¿™ä¸ªisEnabledå˜ä¸ºä¸€ä¸ªobserverï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š 1234567extension Reactive where Base: UITextField &#123; var inputEnabled: UIBindingObserver&lt;Base, Result&gt; &#123; return UIBindingObserver(UIElement: base) &#123; textFiled, result in textFiled.isEnabled = result.isValid &#125; &#125;&#125; UIBindingObserveræ˜¯ä¸€ä¸ªç±»ï¼Œä»–çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå…ƒç´ æœ¬èº«ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…å‚æ•°æ˜¯å…ƒç´ æœ¬èº«ï¼Œè¿˜æœ‰ä»–çš„ä¸€ä¸ªå±žæ€§ã€‚ 1public init(UIElement: UIElementType, binding: @escaping (UIElementType, Value) -&gt; Swift.Void) è‡ªå®šä¹‰äº†ä¸€ä¸ªinputEnabled Observeré‡Œé¢å…³è”çš„UITextFieldçš„isEnabledå±žæ€§ã€‚ å¥½äº†ï¼Œæ–‡ç« åˆ°è¿™é‡Œä¹Ÿå·®ä¸å¤šäº†ï¼Œè¿™ç¯‡æ–‡ç« ä¸­æ²¡æœ‰å®žæˆ˜æ•™ç¨‹ï¼Œä½†ç»å¯¹éƒ½æ˜¯å¹²è´§ï¼Œä¹Ÿè®¸åœ¨ä½ ä¸“ç ”å®˜æ–¹demoçš„æ—¶å€™çœ‹ä¸æ‡‚æŸä¸ªå†™æ³•ï¼Œçœ‹äº†è¿™ç¯‡æ–‡ç« ä½ å°±ä¼šè±ç„¶å¼€æœ—äº†å‘¢ï¼ŸðŸ™„]]></content>
      <tags>
        <tag>RxSwift</tag>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€è½¬è½½ã€‘RxSwift-ä½ æ‰€éœ€è¦çŸ¥é“çš„å„ç§æ¦‚å¿µ]]></title>
    <url>%2F2018%2F01%2F30%2FRxSwift-%E4%BD%A0%E6%89%80%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E5%90%84%E7%A7%8D%E6%A6%82%E5%BF%B5%2F</url>
    <content type="text"><![CDATA[æ­¤æ–‡è½¬è½½è‡³ã€ç”°è…¾é£žçš„åšå®¢ã€‘ ç›¸ä¿¡å¤§å®¶å¾ˆæ—©å°±å¬è¯´è¿‡å‡½æ•°å¼å“åº”ç¼–ç¨‹æ¦‚å¿µï¼Œæˆ‘æ˜¯åŽ»å¹´é¢è¯•çš„æ—¶å€™æŽ¥è§¦åˆ°å‡½æ•°å¼å“åº”ç¼–ç¨‹çš„ï¼Œå½“æ—¶ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æŽ¥è§¦åˆ°MVVMè¿™ä¸ªæ¦‚å¿µï¼Œè½¬çœ¼éƒ½ä¸€å¹´è¿‡åŽ»äº†ï¼Œæˆ‘å´æ²¡æœ‰åœ¨å‡½æ•°å¼å“åº”ç¼–ç¨‹ä¸Šåšæ·±å…¥çš„ç ”ç©¶ï¼Œè¯´æ¥è¿˜çœŸæ˜¯æƒ­æ„§ã€‚ ä¸è¿‡æœ€è¿‘ç”±äºŽæƒ³è¦ä½¿ç”¨RxSwiftï¼Œæ‰€ä»¥è¶è¿™ä¸ªæ—¶å€™å¥½å¥½æŽ¥è§¦å’Œç ”ç©¶ä¸€ä¸‹ä¼ è¯´ä¸­çš„å‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼Œç”±äºŽç½‘ä¸Šå…³äºŽRxSwiftçš„æ•™ç¨‹èµ„æ–™å¾ˆå°‘ï¼Œè¿™ç¯‡æ–‡ç« å…¶å®žå°±æ˜¯æœ€RxSwiftå®˜æ–¹æ–‡æ¡£å’Œä¸€äº›æ¦‚å¿µåšä¸€äº›è§£è¯»ã€‚ç®—æ˜¯å¤§å®¶å­¦ä¹ çš„å‚è€ƒæ–‡ç« å§ï¼ å…ˆæŒ–ä¸ªå‘ï¼Œè¿™å¯èƒ½ä¼šæ˜¯ä¸€ä¸ªRxSwiftç³»åˆ—ï¼Œå¸Œæœ›å¤§å®¶åœ¨å­¦ä¹ çš„æ—¶å€™æœ‰æ‰€å‚è€ƒã€‚ RxSwiftæ˜¯ä»€ä¹ˆRxSwifæ˜¯ReactiveXçš„Swiftç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°å¼å“åº”ç¼–ç¨‹çš„æ¡†æž¶ã€‚å¯¹ï¼Œå°±è¿™ä¸€å¥è¯ã€‚æƒ³è¦çŸ¥é“ä»–åšä»€ä¹ˆçš„ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è§‚å¯Ÿè€…æ¨¡å¼ã€‚ è§‚å¯Ÿè€…æ¨¡å¼å…³äºŽè§‚å¯Ÿè€…æ¨¡å¼æˆ‘æƒ³å¤§ä¼™åº”è¯¥éƒ½å¾ˆäº†è§£äº†å§ï¼Œä»€ä¹ˆKVOï¼Œé€šçŸ¥ç­‰éƒ½æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåœ¨è®¾è®¡æ¨¡å¼ä¸­ä»–å¯æ˜¯ä¸€ä¸ªé‡ä¸­ä¹‹é‡çš„è®¾è®¡æ¨¡å¼å•Šï¼æ¯”å¦‚ä¸€ä¸ªå®å®åœ¨ç¡è§‰ï¼Œçˆ¸çˆ¸å¦ˆå¦ˆï¼Œçˆ·çˆ·å¥¶å¥¶æ€»ä¸èƒ½åœ¨é‚£è¾¹ä¸€åªçœ‹ç€å§ï¼Ÿé‚£æ ·å­å¤ªç´¯äº†ã€‚ä»–ä»¬è¯¥åšå•¥äº‹å°±åšå•¥äº‹å‘—ï¼Œåªè¦å¬åˆ°å®å®çš„å“­å£°ï¼Œä»–ä»¬å°±ç»™å®å®å–‚å¥¶å°±è¡Œäº†ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚å®å®æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œçˆ¸çˆ¸å¦ˆå¦ˆç­‰æ˜¯è§‚å¯Ÿè€…ä¹Ÿç§°ä½œè®¢é˜…è€…ï¼Œåªè¦è¢«è§‚å¯Ÿè€…å‘å‡ºäº†æŸäº›äº‹ä»¶æ¯”å¦‚å®å®å“­å£°ã€å«å£°éƒ½æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œé€šçŸ¥åˆ°è®¢é˜…è€…ï¼Œè®¢é˜…è€…ä»¬å°±å¯ä»¥åšç›¸åº”çš„å¤„ç†å·¥ä½œã€‚å“ˆå“ˆï¼Œè§‚å¯Ÿè€…æ¨¡å¼å¾ˆç®€å•å§ï¼Ÿ RxSwiftåšäº†ä»€ä¹ˆRxSwiftæŠŠæˆ‘ä»¬ç¨‹åºä¸­æ¯ä¸€ä¸ªæ“ä½œéƒ½çœ‹æˆä¸€ä¸ªäº‹ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ªTextFieldä¸­çš„æ–‡æœ¬æ”¹å˜ï¼Œä¸€ä¸ªæŒ‰é’®è¢«ç‚¹å‡»ï¼Œæˆ–è€…ä¸€ä¸ªç½‘ç»œè¯·æ±‚ç»“æŸç­‰ï¼Œæ¯ä¸€ä¸ªäº‹ä»¶æºå°±å¯ä»¥çœ‹æˆä¸€ä¸ªç®¡é“ï¼Œä¹Ÿå°±æ˜¯sequenceï¼Œæ¯”å¦‚TextFieldï¼Œå½“æˆ‘ä»¬æ”¹å˜é‡Œé¢çš„æ–‡æœ¬çš„æ—¶å€™ï¼Œè¿™ä¸ªTextFieldå°±ä¼šä¸æ–­çš„å‘å‡ºäº‹ä»¶ï¼Œä»Žä»–çš„è¿™ä¸ªsequenceä¸­ä¸æ–­çš„æµå‡ºï¼Œæˆ‘ä»¬åªéœ€è¦ç›‘å¬è¿™ä¸ªsequenceï¼Œæ¯æµå‡ºä¸€ä¸ªäº‹ä»¶å°±åšç›¸åº”çš„å¤„ç†ã€‚åŒç†ï¼ŒButtonä¹Ÿæ˜¯ä¸€ä¸ªsequenceï¼Œæ¯ç‚¹å‡»ä¸€æ¬¡å°±æµå‡ºä¸€ä¸ªäº‹ä»¶ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬æŠŠæ¯ä¸€æ­¥éƒ½æƒ³æˆæ˜¯ä¸€ä¸ªäº‹ä»¶å°±å¥½åŽ»ç†è§£RxSwiftäº†ã€‚çœ‹ä¸‹å›¾æ˜¯ä¸æ˜¯å¾ˆå¥½ç†è§£äº†ï¼Ÿ Observableå’ŒObserverç†è§£äº†è§‚å¯Ÿè€…æ¨¡å¼è¿™ä¸¤ä¸ªæ¦‚å¿µå°±å¾ˆå¥½ç†è§£äº†ï¼ŒObservableå°±æ˜¯å¯è¢«è§‚å¯Ÿçš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„å®å®ï¼Œä»–ä¹Ÿæ˜¯äº‹ä»¶æºã€‚è€ŒObserverå°±æ˜¯æˆ‘ä»¬çš„è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯å½“æ”¶åˆ°äº‹ä»¶çš„æ—¶å€™åŽ»åšæŸäº›å¤„ç†çš„çˆ¸çˆ¸å¦ˆå¦ˆã€‚è§‚å¯Ÿè€…éœ€è¦åŽ»è®¢é˜…(subscribe)è¢«è§‚å¯Ÿè€…ï¼Œæ‰èƒ½æ”¶åˆ°Observableçš„äº‹ä»¶é€šçŸ¥æ¶ˆæ¯ã€‚ ä¸‹é¢å¼€å§‹ä¸€äº›åŸºæœ¬æ¦‚å¿µè§£è¯»ï¼Œé€šè¯»ä¸€éä½ ä¼šå¯¹RxSwiftæœ‰éžå¸¸æ·±åˆ»çš„è®¤è¯†äº†ï¼Œå…¶å®žä¹Ÿå°±æ˜¯å¯¹æ•´ç†äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£å’ŒåŠ ä¸Šè‡ªå·±çš„ä¸€äº›ç†è§£ åˆ›å»ºå’Œè®¢é˜…è¢«è§‚å¯Ÿè€…ä¸‹é¢åˆ›å»ºè¢«è§‚å¯Ÿè€…å…¶å®žå°±æ˜¯åˆ›å»ºä¸€ä¸ªObserableçš„sequenceï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªæµï¼Œç„¶åŽå°±å¯ä»¥è¢«è®¢é˜…subscribeï¼Œè¿™æ ·è¢«è§‚å¯Ÿè€…å‘å‡ºäº‹ä»¶æ¶ˆæ¯ï¼Œæˆ‘ä»¬å°±èƒ½åšç›¸åº”çš„å¤„ç† DisposeBagDisposeBagå…¶å®žå°±ç›¸å½“äºŽiOSä¸­çš„ARCï¼Œä¼šåœ¨é€‚å½“çš„æ—¶å€™é”€æ¯è§‚å¯Ÿè€…ï¼Œç›¸å½“äºŽå†…å­˜ç®¡ç†è€…å§ã€‚ subscribesubscribeæ˜¯è®¢é˜…sequenceå‘å‡ºçš„äº‹ä»¶ï¼Œæ¯”å¦‚nextäº‹ä»¶ï¼Œerroräº‹ä»¶ç­‰ã€‚è€Œsubscribe(onNext:)æ˜¯ç›‘å¬sequenceå‘å‡ºçš„nextäº‹ä»¶ä¸­çš„elementè¿›è¡Œå¤„ç†ï¼Œä»–ä¼šå¿½ç•¥errorå’Œcompletedäº‹ä»¶ã€‚ç›¸å¯¹åº”çš„è¿˜æœ‰subscribe(onError:) å’Œ subscribe(onCompleted:) neverneverå°±æ˜¯åˆ›å»ºä¸€ä¸ªsequenceï¼Œä½†æ˜¯ä¸å‘å‡ºä»»ä½•äº‹ä»¶ä¿¡å·ã€‚ 1234567let disposeBag = DisposeBag()let neverSequence = Observable&lt;String&gt;.never() let neverSequenceSubscription = neverSequence .subscribe &#123; _ in print("This will never be printed")&#125;.addDisposableTo(disposeBag) 1ç»“æžœæ˜¯ä»€ä¹ˆéƒ½ä¸æ‰“å° emptyemptyå°±æ˜¯åˆ›å»ºä¸€ä¸ªç©ºçš„sequence,åªèƒ½å‘å‡ºä¸€ä¸ªcompletedäº‹ä»¶ 1234567let disposeBag = DisposeBag() Observable&lt;Int&gt;.empty() .subscribe &#123; event in print(event) &#125; .addDisposableTo(disposeBag) 1completed justjustæ˜¯åˆ›å»ºä¸€ä¸ªsequenceåªèƒ½å‘å‡ºä¸€ç§ç‰¹å®šçš„äº‹ä»¶ï¼Œèƒ½æ­£å¸¸ç»“æŸ 1234567let disposeBag = DisposeBag() Observable.just("ðŸ”´") .subscribe &#123; event in print(event) &#125; .addDisposableTo(disposeBag) 12next(ðŸ”´)completed ofofæ˜¯åˆ›å»ºä¸€ä¸ªsequenceèƒ½å‘å‡ºå¾ˆå¤šç§äº‹ä»¶ä¿¡å· 1234567let disposeBag = DisposeBag() Observable.of("ðŸ¶", "ðŸ±", "ðŸ­", "ðŸ¹") .subscribe(onNext: &#123; element in print(element) &#125;) .addDisposableTo(disposeBag) 1234ðŸ¶ðŸ±ðŸ­ðŸ¹ å¦‚æžœæŠŠä¸Šé¢çš„onNext:åŽ»æŽ‰çš„è¯ï¼Œç»“æžœä¼šæ˜¯è¿™æ ·å­ï¼Œä¹Ÿæ­£å¥½å¯¹åº”äº†æˆ‘ä»¬subscribeä¸­ï¼Œsubscribeåªç›‘å¬äº‹ä»¶ã€‚ 12345next(ðŸ¶)next(ðŸ±)next(ðŸ­)next(ðŸ¹)completed fromfromå°±æ˜¯ä»Žé›†åˆä¸­åˆ›å»ºsequenceï¼Œä¾‹å¦‚æ•°ç»„ï¼Œå­—å…¸æˆ–è€…Set 12345let disposeBag = DisposeBag() Observable.from([&quot;ðŸ¶&quot;, &quot;ðŸ±&quot;, &quot;ðŸ­&quot;, &quot;ðŸ¹&quot;]) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) createæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¯è§‚å¯Ÿçš„sequenceï¼Œé‚£å°±æ˜¯ä½¿ç”¨create createæ“ä½œç¬¦ä¼ å…¥ä¸€ä¸ªè§‚å¯Ÿè€…observerï¼Œç„¶åŽè°ƒç”¨observerçš„onNextï¼ŒonCompletedå’ŒonErroræ–¹æ³•ã€‚è¿”å›žä¸€ä¸ªå¯è§‚å¯Ÿçš„obserableåºåˆ—ã€‚ 12345678910111213let disposeBag = DisposeBag() let myJust = &#123; (element: String) -&gt; Observable&lt;String&gt; in return Observable.create &#123; observer in observer.on(.next(element)) observer.on(.completed) return Disposables.create() &#125;&#125; myJust("ðŸ”´") .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 12next(ðŸ”´)completed rangerangeå°±æ˜¯åˆ›å»ºä¸€ä¸ªsequenceï¼Œä»–ä¼šå‘å‡ºè¿™ä¸ªèŒƒå›´ä¸­çš„ä»Žå¼€å§‹åˆ°ç»“æŸçš„æ‰€æœ‰äº‹ä»¶ 12345let disposeBag = DisposeBag() Observable.range(start: 1, count: 10) .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 1234567891011next(1)next(2)next(3)next(4)next(5)next(6)next(7)next(8)next(9)next(10)completed repeatElementåˆ›å»ºä¸€ä¸ªsequenceï¼Œå‘å‡ºç‰¹å®šçš„äº‹ä»¶næ¬¡ 123456let disposeBag = DisposeBag() Observable.repeatElement("ðŸ”´") .take(3) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123ðŸ”´ðŸ”´ðŸ”´ generategenerateæ˜¯åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿsequenceï¼Œå½“åˆå§‹åŒ–çš„æ¡ä»¶ä¸ºtrueçš„æ—¶å€™ï¼Œä»–å°±ä¼šå‘å‡ºæ‰€å¯¹åº”çš„äº‹ä»¶ 123456789let disposeBag = DisposeBag() Observable.generate( initialState: 0, condition: &#123; $0 &lt; 3 &#125;, iterate: &#123; $0 + 1 &#125; ) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123012 deferreddeferredä¼šä¸ºæ¯ä¸€ä¸ºè®¢é˜…è€…observeråˆ›å»ºä¸€ä¸ªæ–°çš„å¯è§‚å¯Ÿåºåˆ— ä¸‹é¢ä¾‹å­ä¸­æ¯æ¬¡è¿›è¡Œsubscribeçš„æ—¶å€™éƒ½ä¼šåŽ»åˆ›å»ºä¸€ä¸ªæ–°çš„deferredSequenceï¼Œæ‰€ä»¥Emittingä¼šæ‰“å°ä¸¤éã€‚ 1234567891011121314151617181920212223let disposeBag = DisposeBag()var count = 1 let deferredSequence = Observable&lt;String&gt;.deferred &#123; print("Creating \(count)") count += 1 return Observable.create &#123; observer in print("Emitting...") observer.onNext("ðŸ¶") observer.onNext("ðŸ±") observer.onNext("ðŸµ") return Disposables.create() &#125;&#125; deferredSequence .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) deferredSequence .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 12345678910Creating 1Emitting...ðŸ¶ðŸ±ðŸµCreating 2Emitting...ðŸ¶ðŸ±ðŸµ erroråˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿåºåˆ—ï¼Œä½†ä¸å‘å‡ºä»»ä½•æ­£å¸¸çš„äº‹ä»¶ï¼Œåªå‘å‡ºerroräº‹ä»¶å¹¶ç»“æŸ 12345let disposeBag = DisposeBag() Observable&lt;Int&gt;.error(TestError.test) .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 1error(test) doOndoOnæˆ‘æ„Ÿè§‰å°±æ˜¯åœ¨ç›´æŽ¥onNextå¤„ç†æ—¶å€™ï¼Œå…ˆæ‰§è¡ŒæŸä¸ªæ–¹æ³•ï¼ŒdoOnNext( :)æ–¹æ³•å°±æ˜¯åœ¨subscribe(onNext:)å‰è°ƒç”¨ï¼ŒdoOnCompleted(:)å°±æ˜¯åœ¨subscribe(onCompleted:)å‰é¢è°ƒç”¨çš„ã€‚ 123456let disposeBag = DisposeBag() Observable.of("ðŸŽ", "ðŸ", "ðŸŠ", "ðŸ‹") .do(onNext: &#123; print("Intercepted:", $0) &#125;, onError: &#123; print("Intercepted error:", $0) &#125;, onCompleted: &#123; print("Completed") &#125;) .subscribe(onNext: &#123; print($0) &#125;,onCompleted: &#123; print("ç»“æŸ") &#125;) .addDisposableTo(disposeBag) 12345678910Intercepted: ðŸŽðŸŽIntercepted: ðŸðŸIntercepted: ðŸŠðŸŠIntercepted: ðŸ‹ðŸ‹Completedç»“æŸ å­¦ä¼šä½¿ç”¨SubjectsSubjetæ˜¯observableå’ŒObserverä¹‹é—´çš„æ¡¥æ¢ï¼Œä¸€ä¸ªSubjectæ—¢æ˜¯ä¸€ä¸ªObserableä¹Ÿæ˜¯ä¸€ä¸ªObserverï¼Œä»–æ—¢å¯ä»¥å‘å‡ºäº‹ä»¶ï¼Œä¹Ÿå¯ä»¥ç›‘å¬äº‹ä»¶ã€‚ PublishSubjectå½“ä½ è®¢é˜…PublishSubjectçš„æ—¶å€™ï¼Œä½ åªèƒ½æŽ¥æ”¶åˆ°è®¢é˜…ä»–ä¹‹åŽå‘ç”Ÿçš„äº‹ä»¶ã€‚subject.onNext()å‘å‡ºonNextäº‹ä»¶ï¼Œå¯¹åº”çš„è¿˜æœ‰onError()å’ŒonCompleted()äº‹ä»¶ 12345678910let disposeBag = DisposeBag()let subject = PublishSubject&lt;String&gt;() subject.addObserver("1").addDisposableTo(disposeBag)subject.onNext("ðŸ¶")subject.onNext("ðŸ±") subject.addObserver("2").addDisposableTo(disposeBag)subject.onNext("ðŸ…°ï¸")subject.onNext("ðŸ…±ï¸") 123456Subscription: 1 Event: next(ðŸ¶)Subscription: 1 Event: next(ðŸ±)Subscription: 1 Event: next(ðŸ…°ï¸)Subscription: 2 Event: next(ðŸ…°ï¸)Subscription: 1 Event: next(ðŸ…±ï¸)Subscription: 2 Event: next(ðŸ…±ï¸) ReplaySubjectå½“ä½ è®¢é˜…ReplaySubjectçš„æ—¶å€™ï¼Œä½ å¯ä»¥æŽ¥æ”¶åˆ°è®¢é˜…ä»–ä¹‹åŽçš„äº‹ä»¶ï¼Œä½†ä¹Ÿå¯ä»¥æŽ¥å—è®¢é˜…ä»–ä¹‹å‰å‘å‡ºçš„äº‹ä»¶ï¼ŒæŽ¥å—å‡ ä¸ªäº‹ä»¶å–å†³ä¸ŽbufferSizeçš„å¤§å° 12345678910let disposeBag = DisposeBag()let subject = ReplaySubject&lt;String&gt;.create(bufferSize: 1) subject.addObserver("1").addDisposableTo(disposeBag)subject.onNext("ðŸ¶")subject.onNext("ðŸ±") subject.addObserver("2").addDisposableTo(disposeBag)subject.onNext("ðŸ…°ï¸")subject.onNext("ðŸ…±ï¸") 1234567Subscription: 1 Event: next(ðŸ¶)Subscription: 1 Event: next(ðŸ±)Subscription: 2 Event: next(ðŸ±) //è®¢é˜…ä¹‹åŽè¿˜å¯ä»¥æŽ¥å—ä¸€æ¬¡å‰é¢å‘å‡ºçš„äº‹ä»¶Subscription: 1 Event: next(ðŸ…°ï¸)Subscription: 2 Event: next(ðŸ…°ï¸)Subscription: 1 Event: next(ðŸ…±ï¸)Subscription: 2 Event: next(ðŸ…±ï¸) BehaviorSubjectå½“ä½ è®¢é˜…äº†BehaviorSubjectï¼Œä½ ä¼šæŽ¥å—åˆ°è®¢é˜…ä¹‹å‰çš„æœ€åŽä¸€ä¸ªäº‹ä»¶ã€‚ 1234567891011121314let disposeBag = DisposeBag()let subject = BehaviorSubject(value: "ðŸ”´") subject.addObserver("1").addDisposableTo(disposeBag)subject.onNext("ðŸ¶")subject.onNext("ðŸ±") subject.addObserver("2").addDisposableTo(disposeBag)subject.onNext("ðŸ…°ï¸")subject.onNext("ðŸ…±ï¸") subject.addObserver("3").addDisposableTo(disposeBag)subject.onNext("ðŸ")subject.onNext("ðŸŠ") 123456789101112131415Subscription: 1 Event: next(ðŸ”´)Subscription: 1 Event: next(ðŸ¶)Subscription: 1 Event: next(ðŸ±)Subscription: 2 Event: next(ðŸ±) //è®¢é˜…ä¹‹å‰çš„æœ€åŽä¸€ä¸ªäº‹ä»¶Subscription: 1 Event: next(ðŸ…°ï¸)Subscription: 2 Event: next(ðŸ…°ï¸)Subscription: 1 Event: next(ðŸ…±ï¸)Subscription: 2 Event: next(ðŸ…±ï¸)Subscription: 3 Event: next(ðŸ…±ï¸) //è®¢é˜…ä¹‹å‰çš„æœ€åŽä¸€ä¸ªäº‹ä»¶Subscription: 1 Event: next(ðŸ)Subscription: 3 Event: next(ðŸ)Subscription: 2 Event: next(ðŸ)Subscription: 1 Event: next(ðŸŠ)Subscription: 3 Event: next(ðŸŠ)Subscription: 2 Event: next(ðŸŠ) PublishSubject, ReplaySubjectå’ŒBehaviorSubjectæ˜¯ä¸ä¼šè‡ªåŠ¨å‘å‡ºcompletedäº‹ä»¶çš„ã€‚ VariableVariableæ˜¯BehaviorSubjectä¸€ä¸ªåŒ…è£…ç®±ï¼Œå°±åƒæ˜¯ä¸€ä¸ªç®±å­ä¸€æ ·ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦è°ƒç”¨asObservable()æ‹†ç®±ï¼Œé‡Œé¢çš„valueæ˜¯ä¸€ä¸ªBehaviorSubjectï¼Œä»–ä¸ä¼šå‘å‡ºerroräº‹ä»¶ï¼Œä½†æ˜¯ä¼šè‡ªåŠ¨å‘å‡ºcompletedäº‹ä»¶ã€‚ 12345678910let disposeBag = DisposeBag()let variable = Variable("ðŸ”´") variable.asObservable().addObserver("1").addDisposableTo(disposeBag)variable.value = "ðŸ¶"variable.value = "ðŸ±" variable.asObservable().addObserver("2").addDisposableTo(disposeBag)variable.value = "ðŸ…°ï¸"variable.value = "ðŸ…±ï¸" 12345678910Subscription: 1 Event: next(ðŸ”´)Subscription: 1 Event: next(ðŸ¶)Subscription: 1 Event: next(ðŸ±)Subscription: 2 Event: next(ðŸ±)Subscription: 1 Event: next(ðŸ…°ï¸)Subscription: 2 Event: next(ðŸ…°ï¸)Subscription: 1 Event: next(ðŸ…±ï¸)Subscription: 2 Event: next(ðŸ…±ï¸)Subscription: 1 Event: completedSubscription: 2 Event: completed è”åˆæ“ä½œè”åˆæ“ä½œå°±æ˜¯æŠŠå¤šä¸ªObservableæµåˆæˆå•ä¸ªObservableæµ startWithåœ¨å‘å‡ºäº‹ä»¶æ¶ˆæ¯ä¹‹å‰ï¼Œå…ˆå‘å‡ºæŸä¸ªç‰¹å®šçš„äº‹ä»¶æ¶ˆæ¯ã€‚æ¯”å¦‚å‘å‡ºäº‹ä»¶2 ï¼Œ3ç„¶åŽæˆ‘startWith(1)ï¼Œé‚£ä¹ˆå°±ä¼šå…ˆå‘å‡º1ï¼Œç„¶åŽ2 ï¼Œ3. 123456let disposeBag = DisposeBag() Observable.of("2", "3") .startWith("1") .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123123 mergeåˆå¹¶ä¸¤ä¸ªObservableæµåˆæˆå•ä¸ªObservableæµï¼Œæ ¹æ®æ—¶é—´è½´å‘å‡ºå¯¹åº”çš„äº‹ä»¶ 123456789101112131415161718192021let disposeBag = DisposeBag() let subject1 = PublishSubject&lt;String&gt;()let subject2 = PublishSubject&lt;String&gt;() Observable.of(subject1, subject2) .merge() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) subject1.onNext("ðŸ…°ï¸") subject1.onNext("ðŸ…±ï¸") subject2.onNext("â‘ ") subject2.onNext("â‘¡") subject1.onNext("ðŸ†Ž") subject2.onNext("â‘¢") 123456ðŸ…°ï¸ðŸ…±ï¸â‘ â‘¡ðŸ†Žâ‘¢ zipç»‘å®šè¶…è¿‡æœ€å¤šä¸è¶…è¿‡8ä¸ªçš„Observableæµï¼Œç»“åˆåœ¨ä¸€èµ·å¤„ç†ã€‚æ³¨æ„Zipæ˜¯ä¸€ä¸ªäº‹ä»¶å¯¹åº”å¦ä¸€ä¸ªæµä¸€ä¸ªäº‹ä»¶ã€‚ 1234567891011121314151617181920let disposeBag = DisposeBag() let stringSubject = PublishSubject&lt;String&gt;()let intSubject = PublishSubject&lt;Int&gt;() Observable.zip(stringSubject, intSubject) &#123; stringElement, intElement in "\(stringElement) \(intElement)" &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) stringSubject.onNext("ðŸ…°ï¸")stringSubject.onNext("ðŸ…±ï¸") intSubject.onNext(1) intSubject.onNext(2) stringSubject.onNext("ðŸ†Ž")intSubject.onNext(3) 123ðŸ…°ï¸ 1 å°†stringSubjectå’ŒintSubjectåŽ‹ç¼©åˆ°ä¸€èµ·å…±åŒå¤„ç†ðŸ…±ï¸ 2ðŸ†Ž 3 combineLatestç»‘å®šè¶…è¿‡æœ€å¤šä¸è¶…è¿‡8ä¸ªçš„Observableæµï¼Œç»“åˆåœ¨ä¸€èµ·å¤„ç†ã€‚å’ŒZipä¸åŒçš„æ˜¯combineLatestæ˜¯ä¸€ä¸ªæµçš„äº‹ä»¶å¯¹åº”å¦ä¸€ä¸ªæµçš„æœ€æ–°çš„äº‹ä»¶ï¼Œä¸¤ä¸ªäº‹ä»¶éƒ½ä¼šæ˜¯æœ€æ–°çš„äº‹ä»¶ï¼Œå¯å°†ä¸‹å›¾ä¸ŽZipçš„å›¾è¿›è¡Œå¯¹æ¯”ã€‚ 12345678910111213141516171819let disposeBag = DisposeBag() let stringSubject = PublishSubject&lt;String&gt;()let intSubject = PublishSubject&lt;Int&gt;() Observable.combineLatest(stringSubject, intSubject) &#123; stringElement, intElement in "\(stringElement) \(intElement)" &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) stringSubject.onNext("ðŸ…°ï¸") stringSubject.onNext("ðŸ…±ï¸")intSubject.onNext(1) intSubject.onNext(2) stringSubject.onNext("ðŸ†Ž") 123ðŸ…±ï¸ 1ðŸ…±ï¸ 2ðŸ†Ž 2 switchLatestswitchLatestå¯ä»¥å¯¹äº‹ä»¶æµè¿›è¡Œè½¬æ¢ï¼Œæœ¬æ¥ç›‘å¬çš„subject1ï¼Œæˆ‘å¯ä»¥é€šè¿‡æ›´æ”¹variableé‡Œé¢çš„valueæ›´æ¢äº‹ä»¶æºã€‚å˜æˆç›‘å¬subject2äº† 1234567891011121314151617181920212223let disposeBag = DisposeBag() let subject1 = BehaviorSubject(value: "âš½ï¸")let subject2 = BehaviorSubject(value: "ðŸŽ") let variable = Variable(subject1) variable.asObservable() .switchLatest() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) subject1.onNext("ðŸˆ")subject1.onNext("ðŸ€") variable.value = subject2 subject1.onNext("âš¾ï¸") subject2.onNext("ðŸ")variable.value = subject1subject2.onNext("ç”°è…¾é£ž")subject1.onNext("æ²¸è…¾å¤©") 1234567âš½ï¸ðŸˆðŸ€ðŸŽðŸâš¾ï¸æ²¸è…¾å¤© å˜æ¢æ“ä½œmapé€šè¿‡ä¼ å…¥ä¸€ä¸ªå‡½æ•°é—­åŒ…æŠŠåŽŸæ¥çš„sequenceè½¬å˜ä¸ºä¸€ä¸ªæ–°çš„sequenceçš„æ“ä½œ 12345let disposeBag = DisposeBag()Observable.of(1, 2, 3) .map &#123; $0 * $0 &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 1231 æ¯ä¸€ä¸ªå…ƒç´ è‡ªå·±ç›¸ä¹˜49 flatMapå°†ä¸€ä¸ªsequenceè½¬æ¢ä¸ºä¸€ä¸ªsequencesï¼Œå½“ä½ æŽ¥æ”¶ä¸€ä¸ªsequenceçš„äº‹ä»¶ï¼Œä½ è¿˜æƒ³æŽ¥æ”¶å…¶ä»–sequenceå‘å‡ºçš„äº‹ä»¶çš„è¯å¯ä»¥ä½¿ç”¨flatMapï¼Œå¥¹ä¼šå°†æ¯ä¸€ä¸ªsequenceäº‹ä»¶è¿›è¡Œå¤„ç†ä»¥åŽï¼Œç„¶åŽå†ä»¥ä¸€ä¸ªæ–°çš„sequenceå½¢å¼å‘å‡ºäº‹ä»¶ã€‚å’ŒSwiftä¸­çš„æ„æ€å·®ä¸å¤šã€‚ 1234567891011121314151617181920212223242526let disposeBag = DisposeBag() struct Player &#123; var score: Variable&lt;Int&gt; //é‡Œé¢æ˜¯ä¸€ä¸ªVariable&#125; let ðŸ‘¦ðŸ» = Player(score: Variable(80)) let ðŸ‘§ðŸ¼ = Player(score: Variable(90))let ðŸ˜‚ = Player(score: Variable(550)) let player = Variable(ðŸ‘¦ðŸ») //å°†playerè½¬ä¸ºVariable player.asObservable() .flatMap &#123; $0.score.asObservable() &#125;//è½¬æ¢æˆäº†ä¸€ä¸ªæ–°çš„åºåˆ— .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) ðŸ‘¦ðŸ».score.value = 85 player.value = ðŸ‘§ðŸ¼ //æ›´æ¢äº†valueï¼Œç›¸å½“äºŽåˆæ·»åŠ äº†ä¸€ä¸ªsequenceï¼Œä¸¤ä¸ªsequenceéƒ½å¯ä»¥æŽ¥æ”¶ ðŸ‘¦ðŸ».score.value = 95ðŸ‘¦ðŸ».score.value = 222player.value = ðŸ˜‚ ðŸ‘§ðŸ¼.score.value = 100 123456780859095222550100 flatMapLatestflatMapLateståªä¼šæŽ¥æ”¶æœ€æ–°çš„valueäº‹ä»¶ï¼Œå°†ä¸Šä¾‹æ”¹ä¸ºflatMapLatestã€‚ç»“æžœä¸º 1234808590550 scanscanå°±æ˜¯ç»™ä¸€ä¸ªåˆå§‹åŒ–çš„æ•°ï¼Œç„¶åŽä¸æ–­çš„æ‹¿å‰ä¸€ä¸ªç»“æžœå’Œæœ€æ–°çš„å€¼è¿›è¡Œå¤„ç†æ“ä½œã€‚ 12345678let disposeBag = DisposeBag() Observable.of(10, 100, 1000) .scan(1) &#123; aggregateValue, newValue in aggregateValue + newValue &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123111111111 è¿‡æ»¤å’Œçº¦æŸfilterfilterå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è¿‡æ»¤æŽ‰æŸäº›ä¸ç¬¦åˆè¦æ±‚çš„äº‹ä»¶ 1234567891011let disposeBag = DisposeBag() Observable.of( "ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ±", "ðŸ°", "ðŸ¹", "ðŸ¸", "ðŸ±") .filter &#123; $0 == "ðŸ±" &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123ðŸ±ðŸ±ðŸ± distinctUntilChangeddistinctUntilChangedå°±æ˜¯å½“ä¸‹ä¸€ä¸ªäº‹ä»¶ä¸Žå‰ä¸€ä¸ªäº‹ä»¶æ˜¯ä¸åŒäº‹ä»¶çš„äº‹ä»¶æ‰è¿›è¡Œå¤„ç†æ“ä½œ 123456let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ·", "ðŸ±", "ðŸ±", "ðŸ±", "ðŸµ", "ðŸ±") .distinctUntilChanged() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 12345ðŸ±ðŸ·ðŸ±ðŸµðŸ± elementAtåªå¤„ç†åœ¨æŒ‡å®šä½ç½®çš„äº‹ä»¶ 123456let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .elementAt(3) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 1ðŸ¸ singleæ‰¾å‡ºåœ¨sequenceåªå‘å‡ºä¸€æ¬¡çš„äº‹ä»¶ï¼Œå¦‚æžœè¶…è¿‡ä¸€ä¸ªå°±ä¼šå‘å‡ºerroré”™è¯¯ 1234Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .single() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 12ðŸ± //å•ä¸€ä¿¡å·è¶…è¿‡äº†ä¸€ä¸ªReceived unhandled error: /var/folders/hz/v15ld5mj0nqf83d21j13y0tw0000gn/T/./lldb/7229/playground107.swift:69:__lldb_expr_107 -&gt; Sequence contains more than one element. 1234Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .single &#123; $0 == "ðŸ¸" &#125; //é’è›™åªæœ‰ä¸€ä¸ªï¼Œcompleted .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 1234Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ±", "ðŸ°", "ðŸ¶") .single &#123; $0 == "ðŸ°" &#125; //å…”å­æœ‰ä¸¤ä¸ªï¼Œä¼šå‘å‡ºerror .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 1234Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .single &#123; $0 == "ðŸ”µ" &#125; //æ²¡æœ‰è“è‰²çƒï¼Œä¼šå‘å‡ºerror .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) takeåªå¤„ç†å‰å‡ ä¸ªäº‹ä»¶ä¿¡å·, 123456let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .take(3) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123ðŸ±ðŸ°ðŸ¶ takeLaståªå¤„ç†åŽå‡ ä¸ªäº‹ä»¶ä¿¡å· 123456let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .takeLast(3) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123ðŸ¸ðŸ·ðŸµ takeWhileå½“æ¡ä»¶æ»¡è¶³çš„æ—¶å€™è¿›è¡Œå¤„ç† 123456let disposeBag = DisposeBag() Observable.of(1, 2, 3, 4, 5, 6) .takeWhile &#123; $0 &lt; 4 &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123123 takeUntilæŽ¥æ”¶äº‹ä»¶æ¶ˆæ¯ï¼Œç›´åˆ°å¦ä¸€ä¸ªsequenceå‘å‡ºäº‹ä»¶æ¶ˆæ¯çš„æ—¶å€™ã€‚ 12345678910111213141516171819let disposeBag = DisposeBag() let sourceSequence = PublishSubject&lt;String&gt;()let referenceSequence = PublishSubject&lt;String&gt;() sourceSequence .takeUntil(referenceSequence) .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) sourceSequence.onNext("ðŸ±")sourceSequence.onNext("ðŸ°")sourceSequence.onNext("ðŸ¶") referenceSequence.onNext("ðŸ”´") //åœæ­¢æŽ¥æ”¶æ¶ˆæ¯ sourceSequence.onNext("ðŸ¸")sourceSequence.onNext("ðŸ·")sourceSequence.onNext("ðŸµ") 1234next(ðŸ±)next(ðŸ°)next(ðŸ¶)completed skipå–æ¶ˆå‰å‡ ä¸ªäº‹ä»¶ 123456let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .skip(2) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 1234ðŸ¶ðŸ¸ðŸ·ðŸµ skipWhileæ»¡è¶³æ¡ä»¶çš„äº‹ä»¶æ¶ˆæ¯éƒ½å–æ¶ˆ 123456let disposeBag = DisposeBag() Observable.of(1, 2, 3, 4, 5, 6) .skipWhile &#123; $0 &lt; 4 &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 123456 skipWhileWithIndexæ»¡è¶³æ¡ä»¶çš„éƒ½è¢«å–æ¶ˆï¼Œä¼ å…¥çš„é—­åŒ…åŒskipWhileæœ‰ç‚¹åŒºåˆ«è€Œå·² 12345678let disposeBag = DisposeBag() Observable.of("ðŸ±", "ðŸ°", "ðŸ¶", "ðŸ¸", "ðŸ·", "ðŸµ") .skipWhileWithIndex &#123; element, index in index &lt; 3 &#125; .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) skipUntilç›´åˆ°æŸä¸ªsequenceå‘å‡ºäº†äº‹ä»¶æ¶ˆæ¯ï¼Œæ‰å¼€å§‹æŽ¥æ”¶å½“å‰sequenceå‘å‡ºçš„äº‹ä»¶æ¶ˆæ¯ 1234567891011121314151617181920let disposeBag = DisposeBag() let sourceSequence = PublishSubject&lt;String&gt;()let referenceSequence = PublishSubject&lt;String&gt;() sourceSequence .skipUntil(referenceSequence) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) sourceSequence.onNext("ðŸ±")sourceSequence.onNext("ðŸ°")sourceSequence.onNext("ðŸ¶") referenceSequence.onNext("ðŸ”´") sourceSequence.onNext("ðŸ¸")sourceSequence.onNext("ðŸ·")sourceSequence.onNext("ðŸµ")&#125; æ•°å­¦æ“ä½œtoArrayå°†sequenceè½¬æ¢æˆä¸€ä¸ªarrayï¼Œå¹¶è½¬æ¢æˆå•ä¸€äº‹ä»¶ä¿¡å·ï¼Œç„¶åŽç»“æŸ 123456let disposeBag = DisposeBag() Observable.range(start: 1, count: 10) .toArray() .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) 12next([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])completed reduceç”¨ä¸€ä¸ªåˆå§‹å€¼ï¼Œå¯¹äº‹ä»¶æ•°æ®è¿›è¡Œç´¯è®¡æ“ä½œã€‚reduceæŽ¥å—ä¸€ä¸ªåˆå§‹å€¼ï¼Œå’Œä¸€ä¸ªæ“ä½œç¬¦å· 123456let disposeBag = DisposeBag() Observable.of(10, 100, 1000) .reduce(1, accumulator: +) .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) 11111 concatconcatä¼šæŠŠå¤šä¸ªsequenceå’Œå¹¶ä¸ºä¸€ä¸ªsequenceï¼Œå¹¶ä¸”å½“å‰é¢ä¸€ä¸ªsequenceå‘å‡ºäº†completedäº‹ä»¶ï¼Œæ‰ä¼šå¼€å§‹ä¸‹ä¸€ä¸ªsequenceçš„äº‹ä»¶ã€‚ åœ¨ç¬¬ä¸€sequenceå®Œæˆä¹‹å‰ï¼Œç¬¬äºŒä¸ªsequenceå‘å‡ºçš„äº‹ä»¶éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä½†ä¼šæŽ¥æ”¶ä¸€å®Œæˆä¹‹å‰çš„äºŒå‘å‡ºçš„æœ€åŽä¸€ä¸ªäº‹ä»¶ã€‚ä¸å¥½è§£é‡Šï¼Œçœ‹ä¾‹å­è¯´æ˜Ž 12345678910111213141516171819202122232425let disposeBag = DisposeBag() let subject1 = BehaviorSubject(value: "ðŸŽ")let subject2 = BehaviorSubject(value: "ðŸ¶") let variable = Variable(subject1) variable.asObservable() .concat() .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) subject1.onNext("ðŸ")subject1.onNext("ðŸŠ") variable.value = subject2 subject2.onNext("ðŸ±") //1å®Œæˆå‰ï¼Œä¼šè¢«å¿½ç•¥subject2.onNext("teng") //1å®Œæˆå‰ï¼Œä¼šè¢«å¿½ç•¥subject2.onNext("fei") //1å®Œæˆå‰çš„æœ€åŽä¸€ä¸ªï¼Œä¼šè¢«æŽ¥æ”¶ subject1.onCompleted() subject2.onNext("ðŸ­") 12345next(ðŸŽ)next(ðŸ)next(ðŸŠ)next(fei)next(ðŸ­) è¿žæŽ¥æ€§æ“ä½œConnectable Observableæœ‰è®¢é˜…æ—¶ä¸å¼€å§‹å‘å°„äº‹ä»¶æ¶ˆæ¯ï¼Œè€Œæ˜¯ä»…å½“è°ƒç”¨å®ƒä»¬çš„connectï¼ˆï¼‰æ–¹æ³•æ—¶ã€‚è¿™æ ·å°±å¯ä»¥ç­‰å¾…æ‰€æœ‰æˆ‘ä»¬æƒ³è¦çš„è®¢é˜…è€…éƒ½å·²ç»è®¢é˜…äº†ä»¥åŽï¼Œå†å¼€å§‹å‘å‡ºäº‹ä»¶æ¶ˆæ¯ï¼Œè¿™æ ·èƒ½ä¿è¯æˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰è®¢é˜…è€…éƒ½èƒ½æŽ¥æ”¶åˆ°äº‹ä»¶æ¶ˆæ¯ã€‚å…¶å®žä¹Ÿå°±æ˜¯ç­‰å¤§å®¶éƒ½å°±ä½ä»¥åŽï¼Œå¼€å§‹å‘å‡ºæ¶ˆæ¯ã€‚ publishå°†ä¸€ä¸ªæ­£å¸¸çš„sequenceè½¬æ¢æˆä¸€ä¸ªconnectable sequence 1234567891011121314151617let intSequence = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) .publish() _ = intSequence .subscribe(onNext: &#123; print("Subscription 1:, Event: \($0)") &#125;) delay(2) &#123; _ = intSequence.connect() &#125; //ç›¸å½“äºŽæŠŠäº‹ä»¶æ¶ˆæ¯æŽ¨è¿Ÿäº†ä¸¤ç§’ delay(4) &#123; _ = intSequence .subscribe(onNext: &#123; print("Subscription 2:, Event: \($0)") &#125;)&#125; delay(6) &#123; _ = intSequence .subscribe(onNext: &#123; print("Subscription 3:, Event: \($0)") &#125;)&#125; 12345678910Subscription 1:, Event: 0Subscription 1:, Event: 1Subscription 2:, Event: 1Subscription 1:, Event: 2Subscription 2:, Event: 2Subscription 1:, Event: 3Subscription 3:, Event: 3Subscription 2:, Event: 3Subscription 1:, Event: 4Subscription 3:, Event: 4 replayå°†ä¸€ä¸ªæ­£å¸¸çš„sequenceè½¬æ¢æˆä¸€ä¸ªconnectable sequenceï¼Œç„¶åŽå’ŒreplaySubjectç›¸ä¼¼ï¼Œèƒ½æŽ¥æ”¶åˆ°è®¢é˜…ä¹‹å‰çš„äº‹ä»¶æ¶ˆæ¯ã€‚ 1234567891011121314151617let intSequence = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) .replay(5) //æŽ¥æ”¶åˆ°è®¢é˜…ä¹‹å‰çš„5æ¡äº‹ä»¶æ¶ˆæ¯ _ = intSequence .subscribe(onNext: &#123; print("Subscription 1:, Event: \($0)") &#125;) delay(2) &#123; _ = intSequence.connect() &#125; delay(4) &#123; _ = intSequence .subscribe(onNext: &#123; print("Subscription 2:, Event: \($0)") &#125;)&#125; delay(8) &#123; _ = intSequence .subscribe(onNext: &#123; print("Subscription 3:, Event: \($0)") &#125;)&#125; multicastå°†ä¸€ä¸ªæ­£å¸¸çš„sequenceè½¬æ¢æˆä¸€ä¸ªconnectable sequenceï¼Œå¹¶ä¸”é€šè¿‡ç‰¹æ€§çš„subjectå‘é€å‡ºåŽ»ï¼Œæ¯”å¦‚PublishSubjectï¼Œæˆ–è€…replaySubjectï¼ŒbehaviorSubjectç­‰ã€‚ä¸åŒçš„Subjectä¼šæœ‰ä¸åŒçš„ç»“æžœã€‚ 1234567891011121314151617let subject = PublishSubject&lt;Int&gt;() _ = subject .subscribe(onNext: &#123; print("Subject: \($0)") &#125;) let intSequence = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) .multicast(subject) _ = intSequence .subscribe(onNext: &#123; print("\tSubscription 1:, Event: \($0)") &#125;) delay(2) &#123; _ = intSequence.connect() &#125; delay(4) &#123; _ = intSequence .subscribe(onNext: &#123; print("\tSubscription 2:, Event: \($0)") &#125;)&#125; é”™è¯¯å¤„ç†catchErrorJustReturné‡åˆ°erroräº‹ä»¶çš„æ—¶å€™ï¼Œå°±returnä¸€ä¸ªå€¼ï¼Œç„¶åŽç»“æŸ 1234567891011121314let disposeBag = DisposeBag() let sequenceThatFails = PublishSubject&lt;String&gt;() sequenceThatFails .catchErrorJustReturn("ðŸ˜Š") .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) sequenceThatFails.onNext("ðŸ˜¬")sequenceThatFails.onNext("ðŸ˜¨")sequenceThatFails.onNext("ðŸ˜¡")sequenceThatFails.onNext("ðŸ”´")sequenceThatFails.onError(TestError.test) 123456next(ðŸ˜¬)next(ðŸ˜¨)next(ðŸ˜¡)next(ðŸ”´)next(ðŸ˜Š)completed catchErroræ•èŽ·errorè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥è¿”å›žå¦ä¸€ä¸ªsequenceè¿›è¡Œè®¢é˜… 1234567891011121314151617181920let disposeBag = DisposeBag() let sequenceThatFails = PublishSubject&lt;String&gt;()let recoverySequence = PublishSubject&lt;String&gt;() sequenceThatFails .catchError &#123; print("Error:", $0) return recoverySequence &#125; .subscribe &#123; print($0) &#125; .addDisposableTo(disposeBag) sequenceThatFails.onNext("ðŸ˜¬")sequenceThatFails.onNext("ðŸ˜¨")sequenceThatFails.onNext("ðŸ˜¡")sequenceThatFails.onNext("ðŸ”´")sequenceThatFails.onError(TestError.test) recoverySequence.onNext("ðŸ˜Š") 123456next(ðŸ˜¬)next(ðŸ˜¨)next(ðŸ˜¡)next(ðŸ”´)Error: testnext(ðŸ˜Š) retryé‡è§erroräº‹ä»¶å¯ä»¥è¿›è¡Œé‡è¯•ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œå¯ä»¥è¿›è¡Œé‡æ–°è¿žæŽ¥ 1234567891011121314151617181920212223242526let disposeBag = DisposeBag()var count = 1 let sequenceThatErrors = Observable&lt;String&gt;.create &#123; observer in observer.onNext("ðŸŽ") observer.onNext("ðŸ") observer.onNext("ðŸŠ") if count == 1 &#123; observer.onError(TestError.test) print("Error encountered") count += 1 &#125; observer.onNext("ðŸ¶") observer.onNext("ðŸ±") observer.onNext("ðŸ­") observer.onCompleted() return Disposables.create()&#125; sequenceThatErrors .retry(3) //ä¸ä¼ å…¥æ•°å­—çš„è¯ï¼Œåªä¼šé‡è¯•ä¸€æ¬¡ .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) debugdebugæ‰“å°æ‰€æœ‰çš„è®¢é˜…, äº‹ä»¶å’Œdisposals 12345sequenceThatErrors .retry(3) .debug() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(disposeBag) RxSwift.Resources.totalæŸ¥çœ‹RxSwiftæ‰€æœ‰èµ„æºçš„å ç”¨ 1print(RxSwift.Resources.total) å•Šï¼Œæ–‡ç« ç»ˆäºŽç»“æŸï¼Œè¿™ç¯‡æ–‡ç« æ¯”è¾ƒé•¿ï¼ŒåŸºæœ¬ä¸Šæ¶µç›–äº†å®˜æ–¹æ–‡æ¡£æ‰€æœ‰çš„æ¦‚å¿µï¼Œå…¶ä¸­ä¸å…æœ‰äº›é”™è¯¯ä¸Žç–æ¼ï¼Œå¸Œæœ›èƒ½åœ¨ä½ å­¦ä¹ RxSwiftçš„æ—¶å€™èƒ½æœ‰ä¸€äº›å‚è€ƒä»·å€¼å§ï¼ï¼ï¼]]></content>
      <tags>
        <tag>RxSwift</tag>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2017æ—¶é—´ç®¡ç†]]></title>
    <url>%2F2017%2F01%2F06%2F2017%E6%97%B6%E9%97%B4%E7%B2%BE%E5%8A%9B%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[è¿™ä¸¤å¤©ï¼Œå¬äº†ç½—èƒ–2017å¹´è·¨å¹´æ¼”è®²ï¼šâ€æ—¶é—´çš„æœ‹å‹â€ï¼Œé‡Œé¢æåˆ°çš„è®¸å¤šè§‚ç‚¹è¿˜æ˜¯èƒ½è§¦è¾¾æˆ‘çš„å†…å¿ƒçš„ã€‚å…¶ä¸­æœ‰ä¸€ç‚¹å°±æ˜¯ï¼šæœªæ¥äººç±»çš„æˆ˜åœºå°±æ˜¯æ—¶é—´çš„æˆ˜åœºï¼Œå°†æ¥äººä»¬æœ€æ¶ˆè´¹ä¸èµ·çš„å°±æ˜¯æ—¶é—´ã€‚ç»†æ€æžæä¸‹ï¼Œé‚åšäº†å¦‚ä¸‹çš„æ—¶é—´ç®¡ç† å¼ºåŠ¿ æˆ‘ä»¬è¦æ˜Žç¡®ä¸€ç‚¹ï¼šè¦è®©è‡ªå·±æˆé•¿èµ·æ¥ï¼Œå¿…é¡»è¦åœ¨è‡ªå·±èº«ä¸Šå¤šèŠ±æ—¶é—´ å¯¹å®¶äººï¼šä¸œè¥¿å¥½å°±æ˜¯å¥½ï¼Œä¸å¥½å°±æ˜¯ä¸å¥½ï¼Œä¸è¦å†è¯´â€éšä¾¿â€ï¼Œâ€éƒ½å¯ä»¥â€ï¼Œâ€ä½ çœ‹ç€åŠžå§â€ä¹‹ç±»çš„è¯ï¼Œä¸»åŠ¨æå‡ºæƒ³æ³•ï¼Œè§‚ç‚¹ å¯¹æœ‹å‹ï¼šé‚£äº›æ²¡å¿…è¦çš„åº”é…¬ï¼Œä¸æƒ³å‚åŠ çš„æ´»åŠ¨èƒ½æ‹’ç»çš„å°½é‡åŽ»æ‹’ç»ï¼Œä¸è¦ç¢äºŽæƒ…é¢ï¼Œæµªè´¹è‡ªå·±çš„æ—¶é—´ï¼Œè¯¥æ‹’ç»å³æ‹’ç» å¯¹ä¸‹å±žï¼šè¯¥æ‰¹è¯„å°±æ‰¹è¯„ï¼Œè¯¥å¥–èµå°±å¥–èµï¼Œæœ‰è‡ªå·±æ˜Žç¡®çš„æ€åº¦ï¼Œåšäº‹çš„é£Žæ ¼ï¼Œç§¯æžï¼Œä¸»åŠ¨çš„æŽ¨åŠ¨å›¢é˜Ÿçš„å‘å±• å¯¹å·¥ä½œï¼šä¸»åŠ¨æå‡ºæƒ³æ³•ï¼Œæ®ç†åŠ›äº‰ï¼Œå‹‡äºŽæŽ¥å—æŒ‘æˆ˜ï¼Œæ‰¿æ‹…è´£ä»»ï¼Œæœ‰å¾ˆå¼ºçš„è‡ªé©±åŠ› æ•ˆçŽ‡ ä¸è¦æµªè´¹æ—¶é—´åœ¨ä¸€äº›æ— è°“çš„äº‹æƒ…ä¸Šé¢ï¼šæ¯”å¦‚è¯´ï¼Œæ·˜å®ä¸ºäº†2ï¼Œ3å—é’±ï¼Œåœ¨å‡ å®¶æ¯”ä»·äº†åŠå¤©ï¼Œè·Ÿå•†å®¶è®¨ä»·äº†åŠå¤©ï¼Œå…¶å®žæ—©ç‚¹åšå®Œï¼Œåšå…¶ä»–äº‹æƒ…ï¼Œåˆ›é€ ä»·å€¼è¿œè¶…è¿‡é‚£ç‚¹é’± è¦æ¸…æ¥šè‡ªå·±ä»€ä¹ˆæ—¶é—´åšäº‹çš„æ•ˆçŽ‡é«˜ï¼Œä»€ä¹ˆæ—¶é—´åšäº‹çš„æ•ˆçŽ‡ä½Žï¼Œæ•ˆçŽ‡é«˜çš„æ—¶å€™å¤šå®‰æŽ’é‡è¦çš„äº‹æƒ…ï¼Œæ•ˆçŽ‡ä½Žçš„æ—¶å€™å¯ä»¥åšä¸€äº›ç®€å•çš„ï¼Œç”šè‡³æ”¾æ¾çš„äº‹ ä»»åŠ¡ æ˜Žç¡®è‡ªå·±å®šä¸‹çš„äº‹æƒ…å°±å¿…é¡»è¦åšï¼Œå…‹åˆ¶æ‹–å»¶ç—‡ é‡äº‹ä¸è¦æ€¥ï¼Œä¸€ä»¶ä»¶åšå¥½ï¼Œä¸è¦åšäº†ä¸€åŠæ‰”åœ¨é‚£è¾¹ï¼Œç»“æžœå°±ä¸ç®¡äº† æ˜Žç¡®äº‹æƒ…çš„ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆå¤„ç†é‡è¦çš„äº‹ åˆ†é… è®¸å¤šäº‹æƒ…ï¼Œä¸ä¸€å®šè¦äº²åŠ›äº²ä¸ºï¼Œæ‰¾åˆ°åˆé€‚çš„äººï¼ŒæŠŠäº‹æƒ…æ”¾å¿ƒçš„äº¤ç»™ä»–åšï¼Œç”šè‡³ï¼Œåœ¨è‡ªå·±å¯æ‰¿å—çš„èŒƒå›´å†…ï¼ŒèŠ±é’±è¯·äººæ¥åš å¤šåšè‡ªå·±æ“…é•¿çš„ï¼Œèƒ½åˆ›é€ ä»·å€¼çš„äº‹æƒ…ï¼Œé‚£äº›ä¸æ“…é•¿ï¼Œæ‰¾ä¿¡çš„è¿‡çš„äººæ¥å¸®å¿™ æ€»ç»“ ä¸è¦åšè€å¥½äººï¼Œè¦æœ‰æ˜Žç¡®çš„æ€åº¦å€¾å‘ï¼Œä»€ä¹ˆäº‹è¯¥åšï¼Œä»€ä¹ˆäº‹ä¸è¯¥åšï¼Œä»€ä¹ˆäººè¯¥å¸®ï¼Œä»€ä¹ˆäººä¸è¯¥å¸® è‡ªå·±æ—¶é—´ä¸å¤Ÿç”¨çš„æƒ…å†µä¸‹ï¼Œè¦èˆå¾—èŠ±é’±ä¹°åˆ«äººçš„æ—¶é—´ï¼Œä»»ä½•äº‹ä¸ä¸€å®šè¦è‡ªå·±äº²åŠ›äº²ä¸ºï¼Œè¦æ‡‚å¾—åˆ†é…ï¼Œå®‰æŽ’ èº«ä½“æ˜¯é©å‘½çš„æœ¬é’±ï¼Œå·¥ä½œçš„åŒæ—¶è¦æ³¨æ„è‡ªå·±çš„èº«ä½“ï¼Œä¸ç†¬å¤œï¼Œå¤šå¥èº« åšä¸€ä¸ªè‡ªå¾‹çš„äººï¼Œè¯»ä¹¦ï¼Œç»ƒå­—ï¼Œå¥èº«ï¼ŒæŒç»­ï¼ŒåšæŒï¼Œæå‡è‡ªæˆ‘ä¿®å…» æœ€åŽï¼Œè¯´äº†å†å¤šï¼Œä¸€å®šè¦åŽ»å®Œæˆï¼Œä¸ç„¶ï¼Œç„¶å¹¶åµã€‚]]></content>
  </entry>
</search>
